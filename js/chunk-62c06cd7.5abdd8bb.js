(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62c06cd7"],{"98ae":function(t,e,n){"use strict";n.d(e,"c",(function(){return d})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return k})),n.d(e,"j",(function(){return j})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"h",(function(){return x})),n.d(e,"i",(function(){return w})),n.d(e,"k",(function(){return v})),n.d(e,"g",(function(){return g})),n.d(e,"b",(function(){return E}));var r=n("3835"),c=n("1da1"),a=n("5530"),u=(n("96cf"),n("159b"),n("c740"),n("a434"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("b64b"),n("4fad"),n("99af"),n("e71f")),o=n("7a23"),i=n("bcc2"),s=(new Date).getFullYear(),b=(new Date).getMonth()+1,O=new Date(s+"-"+b).getTime(),d=Object(o["M"])([]),p=Object(u["j"])(),f=Object(u["n"])(Object(u["d"])(p,"EXPORTNOTE"),Object(u["r"])("updatedAt",">",O),Object(u["m"])("updatedAt","asc"));Object(u["l"])(f,(function(t){t.docChanges().forEach((function(t){var e=Object(a["a"])(Object(a["a"])({},t.doc.data()),{},{exportNoteID:t.doc.id}),n=d.findIndex((function(e){return e.exportNoteID===t.doc.id}));"added"===t.type?d.unshift(e):"modified"===t.type?d.splice(n,1,e):"removed"===t.type&&d.splice(n,1)}))}));var j=function(t){var e=Object(o["N"])({}),n=Object(u["l"])(Object(u["g"])(p,"EXPORTNOTE",t),function(){var n=Object(c["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.exists()){n.next=2;break}return n.abrupt("return");case 2:e.value=Object(a["a"])(Object(a["a"])({},r.data()),{},{exportNoteID:t});case 3:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}());return{data:e,unSubscribe:n}},l=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("ID must not be empty");case 2:return n=Object(u["g"])(p,"EXPORTNOTE",e),t.next=5,Object(u["h"])(n);case 5:if(r=t.sent,r.exists()){t.next=8;break}throw new Error("ExportNote not found !!!");case 8:return t.abrupt("return",Object(a["a"])(Object(a["a"])({},r.data()),{},{exportNoteID:r.id}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),m=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.map((function(t){return Object(u["h"])(Object(u["g"])(p,"EXPORTNOTE",t))})),t.next=3,Promise.all(n);case 3:return r=t.sent,t.abrupt("return",r.map((function(t){return Object(a["a"])(Object(a["a"])({},t.data()),{},{exportNoteID:t.id})})));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),h=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object(i["a"])(new Date,"YY-MM-DD-HH-mm-ss"),r=Object(u["g"])(p,"EXPORTNOTE",n),t.next=4,Object(u["h"])(r);case 4:if(c=t.sent,!c.exists()){t.next=7;break}throw new Error("Phiếu nhập này đã tồn tại");case 7:return t.next=9,Object(u["p"])(r,Object(a["a"])(Object(a["a"])({},e),{},{status:"Pending",createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),removedAt:0}));case 9:return t.abrupt("return",r.id);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["o"])(p,function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(n){var c,a,o,i,s,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=Object(u["g"])(p,"EXPORTNOTE",e),t.next=3,n.get(c);case 3:if(a=t.sent,a.exists()){t.next=6;break}throw new Error("Document not exists");case 6:if(o=a.data(),i=Object.assign({},o),"Pending"===i.status){t.next=9;break}throw new Error("Notes is not in pending status");case 9:return s=Object.keys(i.stockOut).map((function(t){return n.get(Object(u["g"])(p,"WAREHOUSE",t))})),t.next=12,Promise.all(s);case 12:b=t.sent,b.forEach((function(t){var c=t.data()||{},a=c.stockAvail,o=c.goodsName;Object.entries(i.stockOut[t.id]).forEach((function(t){var e=Object(r["a"])(t,2),n=e[0],c=e[1].quantity;if(!a[n])throw new Error("".concat(o," with ").concat(n," are not available in warehouse"));if(a[n].quantity<c)throw new Error("".concat(o," available is ").concat(a[n].quantity,". But, you have just export ").concat(c));a[n].quantity!==c?a[n].quantity-=c:delete a[n]})),n.update(Object(u["g"])(p,"WAREHOUSE",t.id),{stockAvail:a,exportNoteIDList:Object(u["c"])(e)})})),n.update(Object(u["g"])(p,"CUSTOMER",i.customer.customerID),{exportNoteIDList:Object(u["c"])(e),"finance.debt":Object(u["k"])(i.finance.debt)}),n.update(c,{status:"Success",updatedAt:(new Date).getTime()});case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),w=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["o"])(p,function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(n){var c,o,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=Object(u["g"])(p,"EXPORTNOTE",e),t.next=3,n.get(c);case 3:if(o=t.sent,o.exists()){t.next=6;break}throw new Error("Document not exists");case 6:if(i=o.data(),s=Object.assign({},i),"Success"===s.status){t.next=9;break}throw new Error("Notes is not in success status");case 9:Object.entries(s.stockOut).forEach((function(t){var c=Object(r["a"])(t,2),o=c[0],i=c[1],s={};Object.entries(i).forEach((function(t){var e=Object(r["a"])(t,2),n=e[0],c=e[1].quantity,a="stockAvail."+n+".quantity";s[a]=Object(u["k"])(c)})),n.update(Object(u["g"])(p,"WAREHOUSE",o),Object(a["a"])(Object(a["a"])({},s),{},{exportNoteIDList:Object(u["b"])(e)}))})),n.update(Object(u["g"])(p,"CUSTOMER",s.customer.customerID),{exportNoteIDList:Object(u["b"])(e),"finance.debt":Object(u["k"])(0-s.finance.debt)}),n.update(c,{status:"Pending",updatedAt:(new Date).getTime()});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["o"])(p,function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(r){var c,a,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=Object(u["g"])(p,"EXPORTNOTE",e),t.next=3,r.get(c);case 3:if(a=t.sent,a.exists()){t.next=6;break}throw new Error("Document not exists");case 6:if(o=a.data(),i=Object.assign({},o),"Success"===i.status){t.next=9;break}throw new Error("Notes is not in success status");case 9:r.update(c,{"finance.debt":Object(u["k"])(0-n)}),r.update(Object(u["g"])(p,"CUSTOMER",i.customer.customerID),{"finance.debt":Object(u["k"])(0-n)});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),v=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("ID must not be empty");case 2:return r=Object(u["g"])(p,"EXPORTNOTE",e),t.next=5,Object(u["h"])(r);case 5:if(c=t.sent,c.exists()){t.next=8;break}throw new Error("ExportNote not found !!!");case 8:if("Pending"===c.data().status){t.next=10;break}throw new Error("Notes is not in pending status");case 10:return t.next=12,Object(u["q"])(r,Object(a["a"])(Object(a["a"])({},n),{},{updatedAt:(new Date).getTime()}));case 12:return t.abrupt("return",e);case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),E=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("ID must not be empty");case 2:return n=Object(u["g"])(p,"EXPORTNOTE",e),t.next=5,Object(u["h"])(n);case 5:if(r=t.sent,r.exists()){t.next=8;break}throw new Error("ExportNote not found !!!");case 8:if("Pending"===r.data().status){t.next=10;break}throw new Error("Notes is not in pending status");case 10:return t.next=12,Object(u["e"])(Object(u["g"])(p,"EXPORTNOTE",e));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),k=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object(u["n"])(Object(u["d"])(p,"EXPORTNOTE"),Object(u["r"])("customer.customerID","==",e),Object(u["r"])("status","==","Success"),Object(u["r"])("finance.debt",">",0)),t.next=3,Object(u["i"])(n);case 3:return r=t.sent,c=[],r.forEach((function(t){c.push(Object(a["a"])({exportNoteID:t.id},t.data()))})),t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},c731:function(t,e,n){},d60f:function(t,e,n){"use strict";n("c731")},d81d:function(t,e,n){"use strict";var r=n("23e7"),c=n("b727").map,a=n("1dde"),u=a("map");r({target:"Array",proto:!0,forced:!u},{map:function(t){return c(this,t,arguments.length>1?arguments[1]:void 0)}})},df82:function(t,e,n){"use strict";n.r(e);var r=n("7a23"),c=function(t){return Object(r["L"])("data-v-8ab1317a"),t=t(),Object(r["J"])(),t},a=c((function(){return Object(r["m"])("h1",{class:"title-content"},"Danh sách đơn hàng",-1)})),u={class:"flex justify-between mb-2 items-center"},o={class:"input-text"},i=["value"],s=Object(r["n"])(" Tạo Mới "),b={class:"table"},O=c((function(){return Object(r["m"])("thead",null,[Object(r["m"])("tr",null,[Object(r["m"])("th",null,"#"),Object(r["m"])("th",null,"KH"),Object(r["m"])("th",null,"Ship"),Object(r["m"])("th",null,"T.Toán"),Object(r["m"])("th",null,"Tổng"),Object(r["m"])("th",null,"Nợ"),Object(r["m"])("th",null,"Ngày")])],-1)})),d={class:"text-right"},p={key:0},f=c((function(){return Object(r["m"])("td",{colspan:"10",class:"text-center"},"No data available in table",-1)})),j=[f],l=["onDblclick"],m={class:"text-center"},h={class:"text-left"},x={class:"text-left"},w={class:"text-left"},g={class:"mt-4"},v=Object(r["n"])("Back");function E(t,e,n,c,f,E){var k=Object(r["R"])("PlusOutlined"),N=Object(r["R"])("a-button");return Object(r["I"])(),Object(r["l"])(r["b"],null,[a,Object(r["m"])("div",u,[Object(r["m"])("div",o,[Object(r["m"])("input",{value:c.searchText,onInput:e[0]||(e[0]=function(){return E.handleSearchText&&E.handleSearchText.apply(E,arguments)}),type:"text",placeholder:"Search..."},null,40,i)]),Object(r["o"])(N,{type:"primary",onClick:E.redirectExportNoteCreate},{icon:Object(r["cb"])((function(){return[Object(r["o"])(k)]})),default:Object(r["cb"])((function(){return[s]})),_:1},8,["onClick"])]),Object(r["m"])("div",null,[Object(r["m"])("table",b,[O,Object(r["m"])("tbody",d,[0===E.exportNoteFilter.length?(Object(r["I"])(),Object(r["l"])("tr",p,j)):Object(r["k"])("",!0),(Object(r["I"])(!0),Object(r["l"])(r["b"],null,Object(r["P"])(E.exportNoteFilter,(function(t,e){var n;return Object(r["I"])(),Object(r["l"])("tr",{key:e,onDblclick:function(e){return E.redirectExportNoteDetails(t.exportNoteID)},style:Object(r["z"])("Pending"===t.status?"color: blue; opacity: 0.7":"")},[Object(r["m"])("td",m,Object(r["V"])(E.exportNoteFilter.length-e),1),Object(r["m"])("td",h,Object(r["V"])((null===(n=t.customer)||void 0===n?void 0:n.customerName)||"-"),1),Object(r["m"])("td",x,Object(r["V"])(t.shipping.unit),1),Object(r["m"])("td",w,Object(r["V"])(t.payment.method),1),Object(r["m"])("td",null,Object(r["V"])(t.finance.revenue),1),Object(r["m"])("td",{style:Object(r["z"])("Success"===t.status&t.finance.debt>0?"color: red":"")},Object(r["V"])(t.finance.debt),5),Object(r["m"])("td",null,Object(r["V"])(E.formatDateTime(t.updatedAt)),1)],44,l)})),128))])])]),Object(r["m"])("div",g,[Object(r["o"])(N,{onClick:e[1]||(e[1]=function(e){return t.$router.push({name:"Dashboard",params:{}})})},{default:Object(r["cb"])((function(){return[v]})),_:1})])],64)}n("4de4");var k=n("47ce"),N=n("98ae"),y=n("bcc2"),R={components:{PlusOutlined:k["a"]},setup:function(){return{exportNoteArray:N["c"],searchText:Object(r["N"])("")}},computed:{exportNoteFilter:function(){var t=this;return this.exportNoteArray.filter((function(e){return Object(y["c"])(e.customer.customerName,t.searchText)}))}},methods:{handleSearchText:function(t){this.searchText=t.target.value},redirectExportNoteCreate:function(){this.$router.push({name:"ExportNote Create Modify",params:{mode:"create"}})},redirectExportNoteDetails:function(t){this.$router.push({name:"ExportNote Details",params:{id:t}})},formatDateTime:function(t){return Object(y["a"])(t,"DD/MM/YY")}}},T=(n("d60f"),n("6b0d")),D=n.n(T);const I=D()(R,[["render",E],["__scopeId","data-v-8ab1317a"]]);e["default"]=I}}]);
//# sourceMappingURL=chunk-62c06cd7.5abdd8bb.js.map