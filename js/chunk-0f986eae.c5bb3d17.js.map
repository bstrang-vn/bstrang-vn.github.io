{"version":3,"sources":["webpack:///./node_modules/core-js/internals/engine-ff-version.js","webpack:///./src/firebase/useCustomer.js","webpack:///./node_modules/core-js/modules/es.array.sort.js","webpack:///./node_modules/core-js/internals/engine-webkit-version.js","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/firebase/useExportNote.js","webpack:///./node_modules/core-js/internals/array-sort.js","webpack:///./src/components/common/ModalCreateModifyCustomer.vue","webpack:///./src/components/common/ModalCreateModifyCustomer.vue?a3e5","webpack:///./node_modules/core-js/modules/es.array.map.js","webpack:///./src/components/customer/customer-details/CustomerDetails.vue","webpack:///./src/components/customer/customer-details/ModalPayDebt.vue","webpack:///./src/components/customer/customer-details/ModalPayDebt.vue?9bb4","webpack:///./src/components/customer/customer-details/CustomerDetails.vue?178b","webpack:///./node_modules/core-js/internals/engine-is-ie-or-edge.js"],"names":["userAgent","firefox","match","module","exports","customerArray","reactive","db","getFirestore","qr","query","collection","onSnapshot","snapshot","docChanges","forEach","change","newCustomer","customerID","doc","id","data","customerIndex","findIndex","item","type","push","splice","startRealtimeCustomer","ref","unSubscribe","customerDoc","exists","value","getCustomer","customerRef","getDoc","customerSnap","customerName","phone","address","finance","exportNoteIDList","addCustomer","addDoc","debt","payDebtHistory","createdAt","Date","getTime","updatedAt","removedAt","customer","updateCustomer","customerData","updateDoc","addPayDebt","listNoteDebt","numberPay","runTransaction","transaction","exportNoteID","update","increment","arrayUnion","time","money","deleteCustomer","deleteDoc","$","aCallable","toObject","lengthOfArrayLike","toString","fails","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","test","nativeSort","sort","FAILS_ON_UNDEFINED","undefined","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","index","result","String","fromCharCode","k","v","a","b","length","charAt","FORCED","getSortCompare","comparefn","x","y","target","proto","forced","array","this","call","itemsLength","items","arrayLength","webkit","$find","find","addToUnscopables","FIND","SKIPS_HOLES","Array","callbackfn","arguments","getYear","getFullYear","getMonth","firstDayOfMonth","exportNoteArray","where","orderBy","newNote","noteIndex","unshift","startRealtimeExportNote","noteDoc","getExportNoteById","noteID","Error","noteRef","noteSnap","getExportNoteList","noteIDList","queryExportNoteList","map","Promise","all","exportNoteSnapList","addExportNotePending","noteData","MyFormatDateTime","setDoc","status","processExportNote","exportNoteRef","get","queryGoodsRefList","Object","keys","stockOut","goodsID","goodsDocList","goodsDoc","stockAvail","goodsName","entries","batch","quantity","refundExportNote","listBatchUpdate","batchKey","each","arrayRemove","payDebtExportNote","number","updateExportNotePending","deleteExportNote","getExportNoteListHasDebtByCustomerID","queryNoteList","getDocs","noteListHasDebt","floor","Math","mergeSort","middle","insertionSort","merge","slice","element","j","i","left","right","llength","rlength","lindex","rindex","class","visible","visibleModal","width","title","confirm-loading","confirmModalLoading","afterClose","refreshModal","handleModalCustomerOk","setup","methods","openModal","$emit","console","log","__exports__","render","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","colspan","$refs","modalCustomerCreateModify","modalPayDebt","exportNoteList","note","key","redirectExportNoteDetails","formatDateTime","payment","method","revenue","buyerPaysShip","history","$router","go","confirmDeleteCustomer","loading","loadingDeleteCustomer","startPayDebt","numberPayDebt","changeNumberPayDebt","addon-after","checked","noteListSelect","changeCheckboxSelectDebt","$event","that","filter","reduce","acc","totalPay","Number","message","success","error","components","ModalCustomerCreateModify","ModalPayDebt","route","realtimeCustomer","params","unmounted","watch","handler","after","before","reverse","deep","startDeleteCustomer","name","$notification","open","description","placement","duration","confirm","icon","ExclamationCircleOutlined","content","onOk","UA"],"mappings":"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","file":"js/chunk-0f986eae.c5bb3d17.js","sourcesContent":["var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","import {\n\tgetFirestore,\n\tonSnapshot,\n\tcollection,\n\tdoc,\n\tgetDoc,\n\taddDoc,\n\tupdateDoc,\n\tdeleteDoc,\n\tquery,\n\trunTransaction,\n\tincrement,\n\tarrayUnion,\n} from 'firebase/firestore'\nimport { reactive, ref } from 'vue'\n\nconst customerArray = reactive([])\nconst db = getFirestore()\nconst qr = query(collection(db, 'CUSTOMER'))\n\nonSnapshot(qr, snapshot => {\n\tsnapshot.docChanges().forEach(change => {\n\t\tconst newCustomer = {\n\t\t\tcustomerID: change.doc.id,\n\t\t\t...change.doc.data(),\n\t\t}\n\t\tconst customerIndex = customerArray.findIndex(item => item.customerID === change.doc.id)\n\t\tif (change.type === 'added') {\n\t\t\tcustomerArray.push(newCustomer)\n\t\t} else if (change.type === 'modified') {\n\t\t\tcustomerArray.splice(customerIndex, 1, newCustomer)\n\t\t} else if (change.type === 'removed') {\n\t\t\tcustomerArray.splice(customerIndex, 1)\n\t\t}\n\t})\n})\n\nconst startRealtimeCustomer = customerID => {\n\tconst data = ref({})\n\tconst unSubscribe = onSnapshot(doc(db, 'CUSTOMER', customerID), async customerDoc => {\n\t\tif (!customerDoc.exists()) return\n\t\tdata.value = {\n\t\t\tcustomerID,\n\t\t\t...customerDoc.data(),\n\t\t}\n\t})\n\treturn { data, unSubscribe }\n}\n\nconst getCustomer = async customerID => {\n\tconst customerRef = doc(db, 'CUSTOMER', customerID)\n\tconst customerSnap = await getDoc(customerRef)\n\tif (!customerSnap.exists()) return {}\n\tconst { customerName, phone, address, finance, exportNoteIDList } = customerSnap.data()\n\treturn {\n\t\tcustomerID,\n\t\tcustomerName,\n\t\tphone,\n\t\taddress,\n\t\tfinance,\n\t\texportNoteIDList,\n\t}\n}\n\nconst addCustomer = async data => {\n\tconst customerRef = await addDoc(collection(db, 'CUSTOMER'), {\n\t\tcustomerName: data.customerName,\n\t\tphone: data.phone,\n\t\taddress: data.address,\n\t\tfinance: { debt: 0, payDebtHistory: [] },\n\t\texportNoteIDList: [],\n\n\t\tcreatedAt: new Date().getTime(),\n\t\tupdatedAt: new Date().getTime(),\n\t\tremovedAt: 0,\n\t})\n\n\tconst customer = await getCustomer(customerRef.id)\n\treturn customer\n}\n\nconst updateCustomer = async (customerID, customerData) => {\n\tconst customerRef = doc(db, 'CUSTOMER', customerID)\n\tawait updateDoc(customerRef, {\n\t\tcustomerName: customerData.customerName,\n\t\tphone: customerData.phone,\n\t\taddress: customerData.address,\n\n\t\tupdatedAt: new Date().getTime(),\n\t})\n\n\tconst customer = await getCustomer(customerRef.id)\n\treturn customer\n}\n\nconst addPayDebt = async (customerID, listNoteDebt, numberPay) => {\n\tawait runTransaction(db, async transaction => {\n\t\tlistNoteDebt.forEach(({ exportNoteID, debt }) => {\n\t\t\ttransaction.update(doc(db, 'EXPORTNOTE', exportNoteID), {\n\t\t\t\t'finance.debt': increment(0 - debt),\n\t\t\t})\n\t\t})\n\t\ttransaction.update(doc(db, 'CUSTOMER', customerID), {\n\t\t\t'finance.debt': increment(0 - numberPay),\n\t\t\t'finance.payDebtHistory': arrayUnion({ time: new Date().getTime(), money: numberPay }),\n\t\t})\n\t})\n}\n\nconst deleteCustomer = async customerID => {\n\tawait deleteDoc(doc(db, 'CUSTOMER', customerID))\n\treturn customerID\n}\n\nexport {\n\tcustomerArray,\n\tstartRealtimeCustomer,\n\tgetCustomer,\n\taddCustomer,\n\tupdateCustomer,\n\taddPayDebt,\n\tdeleteCustomer,\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar nativeSort = test.sort;\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? nativeSort.call(array) : nativeSort.call(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) items.push(array[index]);\n    }\n\n    items = internalSort(items, getSortCompare(comparefn));\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","import {\n\tgetFirestore,\n\tonSnapshot,\n\tcollection,\n\tdoc,\n\tgetDoc,\n\tgetDocs,\n\tsetDoc,\n\tupdateDoc,\n\tdeleteDoc,\n\tquery,\n\twhere,\n\torderBy,\n\trunTransaction,\n\tincrement,\n\tarrayUnion,\n\tarrayRemove,\n} from 'firebase/firestore'\nimport { ref, reactive } from 'vue'\nimport { MyFormatDateTime } from '@/utils/convert'\n\nconst getYear = new Date().getFullYear()\nconst getMonth = new Date().getMonth() + 1\nconst firstDayOfMonth = new Date(getYear + '-' + getMonth).getTime()\nconst exportNoteArray = reactive([])\nconst db = getFirestore()\nconst qr = query(collection(db, 'EXPORTNOTE'), where('updatedAt', '>', firstDayOfMonth), orderBy('updatedAt', 'asc'))\n\nonSnapshot(qr, snapshot => {\n\tsnapshot.docChanges().forEach(change => {\n\t\tconst newNote = {\n\t\t\t...change.doc.data(),\n\t\t\texportNoteID: change.doc.id,\n\t\t}\n\t\tconst noteIndex = exportNoteArray.findIndex(item => item.exportNoteID === change.doc.id)\n\t\tif (change.type === 'added') {\n\t\t\texportNoteArray.unshift(newNote)\n\t\t} else if (change.type === 'modified') {\n\t\t\texportNoteArray.splice(noteIndex, 1, newNote)\n\t\t} else if (change.type === 'removed') {\n\t\t\texportNoteArray.splice(noteIndex, 1)\n\t\t}\n\t})\n})\n\nconst startRealtimeExportNote = exportNoteID => {\n\tconst data = ref({})\n\tconst unSubscribe = onSnapshot(doc(db, 'EXPORTNOTE', exportNoteID), async noteDoc => {\n\t\tif (!noteDoc.exists()) return\n\t\tdata.value = {\n\t\t\t...noteDoc.data(),\n\t\t\texportNoteID,\n\t\t}\n\t})\n\treturn { data, unSubscribe }\n}\n\nconst getExportNoteById = async noteID => {\n\tif (!noteID) throw new Error('ID must not be empty')\n\tconst noteRef = doc(db, 'EXPORTNOTE', noteID)\n\tconst noteSnap = await getDoc(noteRef)\n\tif (!noteSnap.exists()) throw new Error('ExportNote not found !!!')\n\treturn {\n\t\t...noteSnap.data(),\n\t\texportNoteID: noteSnap.id,\n\t}\n}\n\nconst getExportNoteList = async noteIDList => {\n\tconst queryExportNoteList = noteIDList.map(noteID => getDoc(doc(db, 'EXPORTNOTE', noteID)))\n\tconst exportNoteSnapList = await Promise.all(queryExportNoteList)\n\treturn exportNoteSnapList.map(noteSnap => ({\n        ...noteSnap.data(),\n\t\texportNoteID: noteSnap.id,\n\t}))\n}\n\nconst addExportNotePending = async noteData => {\n\tconst noteID = MyFormatDateTime(new Date(), 'YY-MM-DD-HH-mm-ss')\n\tconst noteRef = doc(db, 'EXPORTNOTE', noteID)\n\tconst noteSnap = await getDoc(noteRef)\n\tif (noteSnap.exists()) throw new Error('Phiếu nhập này đã tồn tại')\n\n\tawait setDoc(noteRef, {\n\t\t...noteData,\n\t\tstatus: 'Pending',\n\n\t\tcreatedAt: new Date().getTime(),\n\t\tupdatedAt: new Date().getTime(),\n\t\tremovedAt: 0,\n\t})\n\n\treturn noteRef.id\n}\n\nconst processExportNote = async noteID => {\n\tawait runTransaction(db, async transaction => {\n\t\t// transaction get export note\n\t\tconst exportNoteRef = doc(db, 'EXPORTNOTE', noteID)\n\t\tconst noteDoc = await transaction.get(exportNoteRef)\n\t\tif (!noteDoc.exists()) throw new Error('Document not exists')\n\t\tconst { ...noteData } = noteDoc.data()\n\t\tif (noteData.status !== 'Pending') {\n\t\t\tthrow new Error('Notes is not in pending status')\n\t\t}\n\n\t\t// transaction get all Goods Data\n\t\tconst queryGoodsRefList = Object.keys(noteData.stockOut).map(goodsID =>\n\t\t\ttransaction.get(doc(db, 'WAREHOUSE', goodsID)),\n\t\t)\n\t\tconst goodsDocList = await Promise.all(queryGoodsRefList)\n\n\t\t// transaction update stock avail in every goods in warehouse\n\t\tgoodsDocList.forEach(goodsDoc => {\n\t\t\tconst { stockAvail, goodsName } = goodsDoc.data() || {}\n\t\t\tObject.entries(noteData.stockOut[goodsDoc.id]).forEach(([batch, { quantity }]) => {\n\t\t\t\tif (!stockAvail[batch]) {\n\t\t\t\t\tthrow new Error(`${goodsName} with ${batch} are not available in warehouse`)\n\t\t\t\t}\n\t\t\t\tif (stockAvail[batch].quantity < quantity) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t`${goodsName} available is ${stockAvail[batch].quantity}. But, you have just export ${quantity}`,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\tif (stockAvail[batch].quantity === quantity) {\n\t\t\t\t\tdelete stockAvail[batch]\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tstockAvail[batch].quantity -= quantity\n\t\t\t})\n\t\t\ttransaction.update(doc(db, 'WAREHOUSE', goodsDoc.id), {\n\t\t\t\tstockAvail,\n\t\t\t\texportNoteIDList: arrayUnion(noteID),\n\t\t\t})\n\t\t})\n\n\t\t// transaction update customer\n\t\ttransaction.update(doc(db, 'CUSTOMER', noteData.customer.customerID), {\n\t\t\texportNoteIDList: arrayUnion(noteID),\n\t\t\t'finance.debt': increment(noteData.finance.debt),\n\t\t})\n\n\t\ttransaction.update(exportNoteRef, {\n\t\t\tstatus: 'Success',\n\t\t\tupdatedAt: new Date().getTime(),\n\t\t})\n\t})\n}\n\nconst refundExportNote = async noteID => {\n\tawait runTransaction(db, async transaction => {\n\t\tconst exportNoteRef = doc(db, 'EXPORTNOTE', noteID)\n\t\tconst noteDoc = await transaction.get(exportNoteRef)\n\t\tif (!noteDoc.exists()) throw new Error('Document not exists')\n\t\tconst { ...noteData } = noteDoc.data()\n\t\tif (noteData.status !== 'Success') {\n\t\t\tthrow new Error('Notes is not in success status')\n\t\t}\n\t\tObject.entries(noteData.stockOut).forEach(([goodsID, batch]) => {\n\t\t\tconst listBatchUpdate = {}\n\t\t\tObject.entries(batch).forEach(([batchKey, { quantity }]) => {\n\t\t\t\tconst each = 'stockAvail.' + batchKey + '.quantity'\n\t\t\t\tlistBatchUpdate[each] = increment(quantity)\n\t\t\t})\n\t\t\ttransaction.update(doc(db, 'WAREHOUSE', goodsID), {\n\t\t\t\t...listBatchUpdate,\n\t\t\t\texportNoteIDList: arrayRemove(noteID),\n\t\t\t})\n\t\t})\n\n\t\ttransaction.update(doc(db, 'CUSTOMER', noteData.customer.customerID), {\n\t\t\texportNoteIDList: arrayRemove(noteID),\n\t\t\t'finance.debt': increment(0 - noteData.finance.debt),\n\t\t})\n\t\ttransaction.update(exportNoteRef, {\n\t\t\tstatus: 'Pending',\n\t\t\tupdatedAt: new Date().getTime(),\n\t\t})\n\t})\n}\n\nconst payDebtExportNote = async (noteID, number) => {\n\tawait runTransaction(db, async transaction => {\n\t\t// transaction get export note\n\t\tconst exportNoteRef = doc(db, 'EXPORTNOTE', noteID)\n\t\tconst noteDoc = await transaction.get(exportNoteRef)\n\t\tif (!noteDoc.exists()) throw new Error('Document not exists')\n\t\tconst { ...noteData } = noteDoc.data()\n\t\tif (noteData.status !== 'Success') {\n\t\t\tthrow new Error('Notes is not in success status')\n\t\t}\n\n\t\ttransaction.update(exportNoteRef, {\n\t\t\t'finance.debt': increment(0 - number),\n\t\t})\n\t\ttransaction.update(doc(db, 'CUSTOMER', noteData.customer.customerID), {\n\t\t\t'finance.debt': increment(0 - number),\n\t\t})\n\t})\n}\n\nconst updateExportNotePending = async (noteID, noteData) => {\n\tif (!noteID) throw new Error('ID must not be empty')\n\tconst noteRef = doc(db, 'EXPORTNOTE', noteID)\n\tconst noteSnap = await getDoc(noteRef)\n\tif (!noteSnap.exists()) throw new Error('ExportNote not found !!!')\n\tif (noteSnap.data().status !== 'Pending') throw new Error('Notes is not in pending status')\n\n\tawait updateDoc(noteRef, {\n\t\t...noteData,\n\t\tupdatedAt: new Date().getTime(),\n\t})\n\treturn noteID\n}\n\nconst deleteExportNote = async noteID => {\n\tif (!noteID) throw new Error('ID must not be empty')\n\tconst noteRef = doc(db, 'EXPORTNOTE', noteID)\n\tconst noteSnap = await getDoc(noteRef)\n\tif (!noteSnap.exists()) throw new Error('ExportNote not found !!!')\n\tif (noteSnap.data().status !== 'Pending') throw new Error('Notes is not in pending status')\n\n\tawait deleteDoc(doc(db, 'EXPORTNOTE', noteID))\n}\n\nconst getExportNoteListHasDebtByCustomerID = async customerID => {\n\tconst queryNoteList = query(\n\t\tcollection(db, 'EXPORTNOTE'),\n\t\twhere('customer.customerID', '==', customerID),\n\t\twhere('status', '==', 'Success'),\n\t\twhere('finance.debt', '>', 0),\n\t)\n\tconst exportNoteSnapList = await getDocs(queryNoteList)\n\tconst noteListHasDebt = []\n\texportNoteSnapList.forEach(noteSnap => {\n\t\tnoteListHasDebt.push({ exportNoteID: noteSnap.id, ...noteSnap.data() })\n\t})\n\treturn noteListHasDebt\n}\nexport {\n\texportNoteArray,\n\tgetExportNoteList,\n\tgetExportNoteListHasDebtByCustomerID,\n\tstartRealtimeExportNote,\n\tgetExportNoteById,\n\taddExportNotePending,\n\tprocessExportNote,\n\trefundExportNote,\n\tupdateExportNotePending,\n\tpayDebtExportNote,\n\tdeleteExportNote,\n}\n","// TODO: use something more complex like timsort?\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    mergeSort(array.slice(0, middle), comparefn),\n    mergeSort(array.slice(middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n  var result = [];\n\n  while (lindex < llength || rindex < rlength) {\n    if (lindex < llength && rindex < rlength) {\n      result.push(comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]);\n    } else {\n      result.push(lindex < llength ? left[lindex++] : right[rindex++]);\n    }\n  } return result;\n};\n\nmodule.exports = mergeSort;\n","<template>\n\t<a-modal\n\t\tv-model:visible=\"visibleModal\"\n\t\twidth=\"900px\"\n\t\t:title=\"customer.customerID ? 'Update Customer' : 'Create New Customer'\"\n\t\t:confirm-loading=\"confirmModalLoading\"\n\t\t:afterClose=\"refreshModal\"\n\t\t@ok=\"handleModalCustomerOk\"\n\t>\n\t\t<form>\n\t\t\t<div class=\"flex items-center mb-2\">\n\t\t\t\t<div class=\"w-20 flex-none\">Name</div>\n\t\t\t\t<a-input v-model:value=\"customer.customerName\" class=\"flex-auto\" />\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center mb-2\">\n\t\t\t\t<div class=\"w-20 flex-none\">Phone</div>\n\t\t\t\t<a-input v-model:value=\"customer.phone\" class=\"flex-auto\" />\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center mb-2\">\n\t\t\t\t<div class=\"w-20 flex-none\">Address</div>\n\t\t\t\t<a-input v-model:value=\"customer.address\" class=\"flex-auto\" />\n\t\t\t</div>\n\t\t</form>\n\t</a-modal>\n</template>\n\n<script>\nimport { ref } from 'vue'\nimport { getCustomer, addCustomer, updateCustomer } from '@/firebase/useCustomer'\n\nexport default {\n\tsetup() {\n\t\treturn {\n\t\t\tvisibleModal: ref(false),\n\t\t\tconfirmModalLoading: ref(false),\n\t\t\tcustomer: ref({ customerID: '', customerName: '', phone: '', address: '' }),\n\t\t}\n\t},\n\tmethods: {\n\t\tasync openModal(customerID) {\n\t\t\tthis.visibleModal = true\n\t\t\tif (customerID) {\n\t\t\t\tconst data = await getCustomer(customerID)\n\t\t\t\tthis.customer.customerID = data.customerID\n\t\t\t\tthis.customer.customerName = data.customerName\n\t\t\t\tthis.customer.phone = data.phone\n\t\t\t\tthis.customer.address = data.address\n\t\t\t}\n\t\t},\n\t\trefreshModal() {\n\t\t\tthis.customer.customerID = ''\n\t\t\tthis.customer.customerName = ''\n\t\t\tthis.customer.phone = ''\n\t\t\tthis.customer.address = ''\n\t\t\tthis.confirmModalLoading = false\n\t\t},\n\t\tasync handleModalCustomerOk() {\n\t\t\tthis.confirmModalLoading = true\n\t\t\tconst customerData = {\n\t\t\t\tcustomerName: this.customer.customerName,\n\t\t\t\tphone: this.customer.phone,\n\t\t\t\taddress: this.customer.address,\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tif (!this.customer.customerID) {\n\t\t\t\t\tconst customer = await addCustomer(customerData)\n\t\t\t\t\tthis.$emit('actionCustomer', customer)\n\t\t\t\t} else {\n\t\t\t\t\tconst customer = await updateCustomer(this.customer.customerID, customerData)\n\t\t\t\t\tthis.$emit('actionCustomer', customer)\n\t\t\t\t}\n\t\t\t\tthis.visibleModal = false\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log(error)\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n","import { render } from \"./ModalCreateModifyCustomer.vue?vue&type=template&id=35b5e0fd\"\nimport script from \"./ModalCreateModifyCustomer.vue?vue&type=script&lang=js\"\nexport * from \"./ModalCreateModifyCustomer.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\Projects\\\\bstrang-vn\\\\bstrang-vn--vuejs\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","<template>\n\t<h1 class=\"title-content\">Thông tin khách hàng</h1>\n\t<div class=\"flex justify-between\">\n\t\t<div>\n\t\t\t<div class=\"flex\">\n\t\t\t\t<div class=\"w-10\">Tên</div>\n\t\t\t\t<div class=\"w-3\">:</div>\n\t\t\t\t<div>{{ customer.customerName }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"flex\">\n\t\t\t\t<div class=\"w-10\">SĐT</div>\n\t\t\t\t<div class=\"w-3\">:</div>\n\t\t\t\t<div>{{ customer.phone }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"flex\">\n\t\t\t\t<div class=\"w-10\">Đ/c</div>\n\t\t\t\t<div class=\"w-3\">:</div>\n\t\t\t\t<div>{{ customer.address }}</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<a-button @click=\"$refs.modalCustomerCreateModify.openModal(customer.customerID)\">\n\t\t\t\t\tEdit\n\t\t\t\t</a-button>\n\t\t\t\t<ModalCustomerCreateModify ref=\"modalCustomerCreateModify\" />\n\t\t\t</div>\n\t\t</div>\n\t\t<div>\n\t\t\t<div>NỢ</div>\n\t\t\t<div class=\"text-3xl\">{{ customer.finance?.debt }}</div>\n\t\t</div>\n\t\t<div>\n\t\t\t<a-button type=\"primary\" @click=\"$refs.modalPayDebt.openModal(customer)\">\n\t\t\t\tTrả nợ\n\t\t\t</a-button>\n\t\t\t<ModalPayDebt ref=\"modalPayDebt\" />\n\t\t</div>\n\t</div>\n\t<div class=\"mt-4 mb-1 font-bold\">Danh sách đơn hàng</div>\n\t<div class=\"wrapper-table\">\n\t\t<table class=\"table\">\n\t\t\t<thead>\n\t\t\t\t<th>#</th>\n\t\t\t\t<th>Ngày</th>\n\t\t\t\t<th>T.Toán</th>\n\t\t\t\t<th>Tổng</th>\n\t\t\t\t<th>Nợ</th>\n\t\t\t</thead>\n\t\t\t<tbody class=\"text-right\">\n\t\t\t\t<tr v-if=\"exportNoteList.length === 0\">\n\t\t\t\t\t<td class=\"text-center\" colspan=\"7\">No data available in table</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr\n\t\t\t\t\tv-for=\"(note, noteIndex) in exportNoteList\"\n\t\t\t\t\t:key=\"noteIndex\"\n\t\t\t\t\t@dblclick=\"redirectExportNoteDetails(note.exportNoteID)\"\n\t\t\t\t>\n\t\t\t\t\t<td class=\"text-center\">{{ noteIndex + 1 }}</td>\n\t\t\t\t\t<td>{{ formatDateTime(note.createdAt) }}</td>\n\t\t\t\t\t<td class=\"text-left\">{{ note.payment?.method }}</td>\n\t\t\t\t\t<td>{{ note.finance.revenue + note.finance.buyerPaysShip }}</td>\n\t\t\t\t\t<td class=\"font-bold\">\n\t\t\t\t\t\t{{ note.finance.debt }}\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n\t<div class=\"mt-8 font-bold\">Lịch sử trả nợ</div>\n\t<div class=\"wrapper-table mb-2\">\n\t\t<table class=\"table\">\n\t\t\t<thead>\n\t\t\t\t<th>#</th>\n\t\t\t\t<th>Thời gian</th>\n\t\t\t\t<th>Tiền trả</th>\n\t\t\t</thead>\n\t\t\t<tbody class=\"text-right\">\n\t\t\t\t<tr v-if=\"payDebtHistory.length == 0\">\n\t\t\t\t\t<td class=\"text-center\" colspan=\"3\">No data available in table</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr v-for=\"(history, index) in payDebtHistory\" :key=\"index\">\n\t\t\t\t\t<td class=\"text-center\">{{ index + 1 }}</td>\n\t\t\t\t\t<td>{{ formatDateTime(history.time) }}</td>\n\t\t\t\t\t<td>{{ history.money }}</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n\t<div class=\"flex justify-between mt-4\">\n\t\t<a-button @click=\"$router.go(-1)\">Back</a-button>\n\t\t<a-button\n\t\t\tv-if=\"customer.exportNoteIDList?.length === 0\"\n\t\t\t@click=\"confirmDeleteCustomer\"\n\t\t\t:loading=\"loadingDeleteCustomer\"\n\t\t\ttype=\"dashed\"\n\t\t>\n\t\t\tDelete\n\t\t</a-button>\n\t</div>\n</template>\n\n<script>\nimport { ref, createVNode } from 'vue'\nimport { useRoute } from 'vue-router'\nimport { Modal, message } from 'ant-design-vue'\nimport { ExclamationCircleOutlined } from '@ant-design/icons-vue'\nimport { startRealtimeCustomer, deleteCustomer } from '@/firebase/useCustomer'\nimport { getExportNoteList } from '@/firebase/useExportNote'\nimport ModalCustomerCreateModify from '@/components/common/ModalCreateModifyCustomer.vue'\nimport ModalPayDebt from '@/components/customer/customer-details/ModalPayDebt.vue'\nimport { MyFormatDateTime } from '@/utils/convert'\n\nexport default {\n\tcomponents: { ModalCustomerCreateModify, ModalPayDebt },\n\tsetup() {\n\t\tconst route = useRoute()\n\t\tconst realtimeCustomer = startRealtimeCustomer(route.params.id)\n\t\treturn {\n\t\t\tcustomer: realtimeCustomer.data,\n\t\t\trealtimeCustomer,\n\t\t\texportNoteList: ref([]),\n\t\t\tpayDebtHistory: ref([]),\n\t\t\tloadingDeleteCustomer: ref(false),\n\t\t}\n\t},\n\tunmounted() {\n\t\tthis.realtimeCustomer.unSubscribe()\n\t},\n\twatch: {\n\t\t'customer.exportNoteIDList': {\n\t\t\tasync handler(after, before) {\n\t\t\t\tthis.exportNoteList = (await getExportNoteList(after)).reverse()\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t\t'customer.finance.payDebtHistory': {\n\t\t\tasync handler(after, before) {\n\t\t\t\tthis.payDebtHistory = after.sort((a, b) => {\n\t\t\t\t\tif (a.time > b.time) return -1\n\t\t\t\t\tif (a.time < b.time) return 1\n\t\t\t\t\treturn 0\n\t\t\t\t})\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\tmethods: {\n\t\tasync startDeleteCustomer() {\n\t\t\tthis.loadingDeleteCustomer = true\n\t\t\ttry {\n\t\t\t\tthis.realtimeCustomer.unSubscribe()\n\t\t\t\tawait deleteCustomer(this.customer.customerID)\n\t\t\t\tthis.$router.push({ name: 'Customer List', params: {} })\n\t\t\t\tmessage.success('Delete customer success !!!', 2)\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(error)\n\t\t\t\tmessage.error(error.toString(), 10)\n\t\t\t} finally {\n\t\t\t\tthis.loadingDeleteCustomer = false\n\t\t\t}\n\t\t},\n\t\tconfirmDeleteCustomer() {\n\t\t\tif (this.customer.exportNoteIDList.length > 0) {\n\t\t\t\tthis.$notification.open({\n\t\t\t\t\tmessage: 'Lỗi !!!',\n\t\t\t\t\tdescription: 'Đơn hàng của khách hàng này vẫn tồn tại. Không thể xóa khách hàng này',\n\t\t\t\t\tplacement: 'topRight',\n\t\t\t\t\tduration: 5,\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst that = this\n\t\t\tModal.confirm({\n\t\t\t\ttitle: 'Confirm',\n\t\t\t\ticon: createVNode(ExclamationCircleOutlined),\n\t\t\t\tcontent: 'Bạn có chắc chắn muốn xóa khách hàng này ?',\n\t\t\t\tonOk() {\n\t\t\t\t\tthat.startDeleteCustomer()\n\t\t\t\t},\n\t\t\t})\n\t\t},\n\t\tredirectExportNoteDetails(noteID) {\n\t\t\tthis.$router.push({\n\t\t\t\tname: 'ExportNote Details',\n\t\t\t\tparams: { id: noteID },\n\t\t\t})\n\t\t},\n\t\tformatDateTime(time) {\n\t\t\treturn MyFormatDateTime(time, 'DD/MM/YY')\n\t\t},\n\t},\n}\n</script>\n","<template>\n\t<a-modal\n\t\tv-model:visible=\"visibleModal\"\n\t\t:confirm-loading=\"confirmModalLoading\"\n\t\t@ok=\"startPayDebt\"\n\t\t:afterClose=\"refreshModal\"\n\t\ttitle=\"Trả nợ\"\n\t\twidth=\"600px\"\n\t>\n\t\t<div class=\"flex items-center mb-2\">\n\t\t\t<div class=\"w-28 flex-none\">Số tiền</div>\n\t\t\t<a-input\n\t\t\t\t:value=\"numberPayDebt\"\n\t\t\t\t@update:value=\"changeNumberPayDebt\"\n\t\t\t\ttype=\"number\"\n\t\t\t\taddon-after=\".000 vnđ\"\n\t\t\t\tclass=\"flex-auto\"\n\t\t\t/>\n\t\t</div>\n\t\t<div class=\"items-center mb-2\">\n\t\t\t<div class=\"w-28 flex-none\">Đơn hàng nợ</div>\n\t\t\t<div>\n\t\t\t\t<div v-for=\"(note, index) in noteListHasDebt\" :key=\"index\" class=\"mb-3\">\n\t\t\t\t\t<a-checkbox\n\t\t\t\t\t\t:checked=\"!!noteListSelect.find(item => item.exportNoteID === note.exportNoteID)\"\n\t\t\t\t\t\t@update:checked=\"changeCheckboxSelectDebt($event, note)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"inline-block w-10\">\n\t\t\t\t\t\t\t{{ noteListSelect.find(item => item.exportNoteID === note.exportNoteID)?.debt }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"inline-block w-20\">/{{ note.finance.debt }}</span>\n\t\t\t\t\t\t<span class=\"inline-block w-20\">{{ formatDateTime(note.updatedAt) }}</span>\n\t\t\t\t\t\t<span>Tổng: {{ note.finance.revenue + note.finance.buyerPaysShip }}</span>\n\t\t\t\t\t</a-checkbox>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</a-modal>\n</template>\n\n<script>\nimport { ref } from 'vue'\nimport { message } from 'ant-design-vue'\nimport { addPayDebt } from '@/firebase/useCustomer'\nimport { getExportNoteListHasDebtByCustomerID } from '@/firebase/useExportNote'\nimport { MyFormatDateTime } from '@/utils/convert'\n\nexport default {\n\tsetup() {\n\t\treturn {\n\t\t\tvisibleModal: ref(false),\n\t\t\tconfirmModalLoading: ref(false),\n\t\t\tcustomer: ref({}),\n\t\t\tnumberPayDebt: ref(0),\n\t\t\tnoteListHasDebt: ref([]),\n\t\t\tnoteListSelect: ref([]),\n\t\t}\n\t},\n\tmethods: {\n\t\tasync openModal(customer) {\n\t\t\tconst that = this\n\t\t\tthis.visibleModal = true\n\t\t\tthis.customer = customer\n\n\t\t\tthis.noteListHasDebt = (await getExportNoteListHasDebtByCustomerID(customer.customerID)).sort((a, b) => {\n\t\t\t\tif (a.updatedAt > b.updatedAt) return -1\n\t\t\t\tif (a.updatedAt < b.updatedAt) return 1\n\t\t\t\treturn 0\n\t\t\t})\n\t\t\tthis.noteListHasDebt.forEach(note => {\n\t\t\t\tthat.noteListSelect.push({\n\t\t\t\t\texportNoteID: note.exportNoteID,\n\t\t\t\t\tdebt: note.finance.debt,\n\t\t\t\t})\n\t\t\t\tthis.numberPayDebt += note.finance.debt\n\t\t\t})\n\t\t},\n\t\trefreshModal() {\n\t\t\tthis.customer = {}\n\t\t\tthis.numberPayDebt = 0\n\t\t\tthis.noteListSelect = []\n\t\t\tthis.noteListHasDebt = []\n\t\t},\n\t\tchangeCheckboxSelectDebt($event, note) {\n\t\t\tif ($event) {\n\t\t\t\tthis.noteListSelect.push({\n\t\t\t\t\texportNoteID: note.exportNoteID,\n\t\t\t\t\tdebt: note.finance.debt,\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tthis.noteListSelect = this.noteListSelect.filter(item => item.exportNoteID !== note.exportNoteID)\n\t\t\t}\n\t\t\tthis.numberPayDebt = this.noteListSelect.reduce((acc, item) => {\n\t\t\t\tacc += item.debt\n\t\t\t\treturn acc\n\t\t\t}, 0)\n\t\t},\n\t\tchangeNumberPayDebt($event) {\n\t\t\tlet totalPay = Number($event)\n\t\t\tthis.noteListSelect = []\n\t\t\tfor (let i = this.noteListHasDebt.length - 1; i >= 0; i -= 1) {\n\t\t\t\tif (totalPay === 0) break\n\t\t\t\tconst { exportNoteID, finance } = this.noteListHasDebt[i]\n\t\t\t\tconst { debt } = finance\n\t\t\t\tif (totalPay > debt) {\n\t\t\t\t\tthis.noteListSelect.push({ exportNoteID, debt })\n\t\t\t\t\ttotalPay -= debt\n\t\t\t\t} else {\n\t\t\t\t\tthis.noteListSelect.push({ exportNoteID, debt: totalPay })\n\t\t\t\t\ttotalPay = 0\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.numberPayDebt = Number($event) - totalPay\n\t\t},\n\t\tasync startPayDebt() {\n\t\t\tthis.confirmModalLoading = true\n\t\t\ttry {\n\t\t\t\tawait addPayDebt(this.customer.customerID, this.noteListSelect, this.numberPayDebt)\n\t\t\t\tmessage.success(`Trả nợ thành công: ${this.numberPayDebt}`, 2)\n\t\t\t\tthis.visibleModal = false\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(error)\n\t\t\t\tmessage.error(error.toString(), 10)\n\t\t\t} finally {\n\t\t\t\tthis.confirmModalLoading = false\n\t\t\t}\n\t\t},\n\t\tformatDateTime(time) {\n\t\t\treturn MyFormatDateTime(time, 'DD/MM/YY')\n\t\t},\n\t},\n}\n</script>\n\n<style></style>\n","import { render } from \"./ModalPayDebt.vue?vue&type=template&id=29f631fc\"\nimport script from \"./ModalPayDebt.vue?vue&type=script&lang=js\"\nexport * from \"./ModalPayDebt.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\Projects\\\\bstrang-vn\\\\bstrang-vn--vuejs\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./CustomerDetails.vue?vue&type=template&id=1ee6445e\"\nimport script from \"./CustomerDetails.vue?vue&type=script&lang=js\"\nexport * from \"./CustomerDetails.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\Projects\\\\bstrang-vn\\\\bstrang-vn--vuejs\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n"],"sourceRoot":""}