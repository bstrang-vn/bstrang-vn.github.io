(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["export-note-list"],{"15fd":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n("a4d3"),n("b64b");function r(t,e){if(null==t)return{};var n,r,c={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(c[n]=t[n]);return c}function c(t,e){if(null==t)return{};var n,c,a=r(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(c=0;c<o.length;c++)n=o[c],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}},"222b":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s}));var r=n("1da1"),c=(n("96cf"),n("159b"),n("e71f")),a=n("7a23"),o=Object(a["L"])({}),u=Object(c["h"])(),i=Object(c["l"])(Object(c["c"])(u,"CUSTOMER"));Object(c["j"])(i,(function(t){t.docChanges().forEach((function(t){"added"===t.type||"modified"===t.type?o[t.doc.id]=t.doc.data():"removed"===t.type&&delete o[t.doc.id]}))}));var s=function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,i,s,d,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["a"])(Object(c["c"])(u,"CUSTOMER"),{customerName:e.customerName,phone:e.phone,address:e.address,debt:e.debt||0,createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),removedAt:0});case 2:return n=t.sent,t.next=5,Object(c["f"])(n);case 5:return r=t.sent,a=r.id,o=r.data(),i=o.customerName,s=o.phone,d=o.address,b=o.debt,t.abrupt("return",{customerID:a,customerName:i,phone:s,address:d,debt:b});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},"3e35":function(t,e,n){"use strict";n("5004")},5004:function(t,e,n){},"98ae":function(t,e,n){"use strict";n.d(e,"b",(function(){return O})),n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return j}));var r=n("4f96"),c=n("2909"),a=n("15fd"),o=n("3835"),u=n("1da1"),i=(n("96cf"),n("159b"),n("d81d"),n("b64b"),n("d3b7"),n("3ca3"),n("ddb0"),n("4fad"),n("99af"),n("fb6a"),n("e71f")),s=n("7a23"),d=["customerID","stockOut"],b=(new Date).getTime(),O=Object(s["L"])({}),l=Object(i["h"])(),p=Object(i["l"])(Object(i["c"])(l,"EXPORTNOTE"),Object(i["p"])("updatedAt",">",b-6048e5),Object(i["k"])("updatedAt","asc"),Object(i["i"])(10));Object(i["j"])(p,(function(t){t.docChanges().forEach((function(t){"added"!==t.type&&"modified"!==t.type||(O[t.doc.id]=t.doc.data()),"removed"===t.type&&delete O[t.doc.id]}))}));var m=function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object(i["e"])(Object(i["c"])(l,"EXPORTNOTE")),t.next=3,Object(i["m"])(l,function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(r){var c,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=Object.keys(e.stockOut).map((function(t){return r.get(Object(i["e"])(l,"WAREHOUSE",t))})),t.next=3,Promise.all(c);case 3:a=t.sent,a.forEach((function(t){var c=t.data()||{},a=c.stockAvail,u=c.goodsName;Object.entries(e.stockOut[t.id]).forEach((function(t){var e=Object(o["a"])(t,2),n=e[0],r=e[1].quantity;if(!a[n])throw new Error("".concat(u," with ").concat(n," are not available in warehouse"));if(a[n].quantity<r)throw new Error("".concat(u," available is ").concat(a[n].quantity,". But, you have just export ").concat(r));a[n].quantity!==r?a[n].quantity-=r:delete a[n]})),r.update(Object(i["e"])(l,"WAREHOUSE",t.id),{stockAvail:a,exportNoteIDList:Object(i["b"])(n.id)})})),r.set(n,{customerID:e.customerID,shipping:e.shipping,payment:e.payment,stockOut:e.stockOut,totalMoney:e.totalMoney,createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),removedAt:0}),r.update(Object(i["e"])(l,"CUSTOMER",e.customerID),{exportNoteIDList:Object(i["b"])(n.id)});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,o,u,s,b,O,p,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object(i["e"])(l,"EXPORTNOTE",e),t.next=3,Object(i["f"])(n);case 3:if(o=t.sent,o.exists()){t.next=6;break}throw new Error("No such document !");case 6:return u=o.data(),s=u.customerID,b=u.stockOut,O=Object(a["a"])(u,d),p=Object(i["f"])(Object(i["e"])(l,"CUSTOMER",s)),m=Object.keys(b).map((function(t){return Object(i["f"])(Object(i["e"])(l,"WAREHOUSE",t))})),t.next=11,Promise.all([p].concat(Object(c["a"])(m))).then((function(t){var e=Object(r["a"])(t),n=e[0],c=e.slice(1);O.customer={customerID:n.id,customerName:n.data().customerName},c.forEach((function(t){b[t.id].goodsName=t.data().goodsName}))}));case 11:return t.abrupt("return",{noteID:n.id,customer:O.customer,stockOut:b,shipping:O.shipping,payment:O.payment,totalMoney:O.totalMoney,createdAt:O.createdAt,updatedAt:O.updatedAt,removedAt:O.removedAt});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},b65c:function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return d}));var r=n("5530"),c=n("1da1"),a=(n("96cf"),n("159b"),n("e71f")),o=n("7a23"),u=Object(o["L"])({}),i=Object(a["h"])();Object(a["j"])(Object(a["l"])(Object(a["c"])(i,"WAREHOUSE")),(function(t){t.docChanges().forEach((function(t){"added"===t.type||"modified"===t.type?u[t.doc.id]=t.doc.data():"removed"===t.type&&delete u[t.doc.id]}))}));var s=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,c,o,u,s,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.goodsName,c=e.group,o=e.retailPrice,u=e.wholesalePrice,t.next=3,Object(a["a"])(Object(a["c"])(i,"WAREHOUSE"),{goodsName:n,group:c,retailPrice:o,wholesalePrice:u,stockAvail:{},importNoteIDList:[],exportNoteIDList:[],createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),removedAt:0});case 3:return s=t.sent,t.next=6,Object(a["f"])(s);case 6:return d=t.sent,t.abrupt("return",Object(r["a"])({goodsID:d.id},d.data()));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var c,o,u,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=n.retailPrice,o=n.wholesalePrice,u=Object(a["e"])(i,"WAREHOUSE",e),t.next=4,Object(a["o"])(u,{retailPrice:c,wholesalePrice:o,updatedAt:(new Date).getTime()});case 4:return t.next=6,Object(a["f"])(u);case 6:return s=t.sent,t.abrupt("return",Object(r["a"])({goodsID:s.id},s.data()));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},d81d:function(t,e,n){"use strict";var r=n("23e7"),c=n("b727").map,a=n("1dde"),o=a("map");r({target:"Array",proto:!0,forced:!o},{map:function(t){return c(this,t,arguments.length>1?arguments[1]:void 0)}})},df82:function(t,e,n){"use strict";n.r(e);n("b64b");var r=n("7a23"),c=function(t){return Object(r["K"])("data-v-83ffcd4c"),t=t(),Object(r["I"])(),t},a={class:"btn-add-export-note"},o=Object(r["n"])(" Add ExportNote "),u={class:"export-note-table"},i={class:"table"},s=c((function(){return Object(r["m"])("thead",null,[Object(r["m"])("tr",null,[Object(r["m"])("th",{rowspan:"2"},"#"),Object(r["m"])("th",{rowspan:"2"},"Customer"),Object(r["m"])("th",{colspan:"3"},"Ship"),Object(r["m"])("th",{colspan:"2"},"Payment"),Object(r["m"])("th",{rowspan:"2"},"Created At")]),Object(r["m"])("tr",null,[Object(r["m"])("th",null,"Unit"),Object(r["m"])("th",null,"State"),Object(r["m"])("th",null,"Cost"),Object(r["m"])("th",null,"Method"),Object(r["m"])("th",null,"Paid/Total")])],-1)})),d={key:0},b=c((function(){return Object(r["m"])("td",{colspan:"10",style:{"text-align":"center"}},"No data available in table",-1)})),O=[b],l=["onClick"],p={style:{"text-align":"right"}},m={style:{"text-align":"right"}},j={style:{"text-align":"right"}};function f(t,e,n,c,b,f){var h=Object(r["Q"])("PlusOutlined"),v=Object(r["Q"])("a-button");return Object(r["H"])(),Object(r["l"])(r["b"],null,[Object(r["m"])("div",a,[Object(r["o"])(v,{type:"primary",onClick:f.handleAddExportNote},{icon:Object(r["bb"])((function(){return[Object(r["o"])(h)]})),default:Object(r["bb"])((function(){return[o]})),_:1},8,["onClick"])]),Object(r["m"])("div",u,[Object(r["m"])("table",i,[s,Object(r["m"])("tbody",null,[0===Object.keys(c.exportNoteList).length?(Object(r["H"])(),Object(r["l"])("tr",d,O)):Object(r["k"])("",!0),(Object(r["H"])(!0),Object(r["l"])(r["b"],null,Object(r["O"])(c.exportNoteList,(function(t,e,n){var a;return Object(r["H"])(),Object(r["l"])("tr",{key:n,onClick:function(t){return f.showExportNoteDetail(e)}},[Object(r["m"])("td",null,Object(r["U"])(n+1),1),Object(r["m"])("td",null,Object(r["U"])((null===(a=c.customerList[t.customerID])||void 0===a?void 0:a.customerName)||"--"),1),Object(r["m"])("td",null,Object(r["U"])(t.shipping.unit),1),Object(r["m"])("td",null,Object(r["U"])(t.shipping.state),1),Object(r["m"])("td",p,Object(r["U"])(t.shipping.cost),1),Object(r["m"])("td",null,Object(r["U"])(t.payment.method),1),Object(r["m"])("td",m,Object(r["U"])(t.payment.alreadyPaid)+" / "+Object(r["U"])(t.totalMoney),1),Object(r["m"])("td",j,Object(r["U"])(f.formatDateTime(t.createdAt)),1)],8,l)})),128))])])])],64)}var h=n("47ce"),v=n("98ae"),g=n("222b"),y=n("b65c"),w=n("bcc2"),x={components:{PlusOutlined:h["a"]},setup:function(){return{exportNoteList:v["b"],customerList:g["b"],goodsList:y["b"]}},methods:{handleAddExportNote:function(){this.$router.push({name:"ExportNote Add",params:{}})},formatDateTime:function(t){return Object(w["a"])(t,"DD/MM/YY")},showExportNoteDetail:function(t){this.$router.push({name:"ExportNote Detail",params:{id:t}})}}},E=(n("3e35"),n("6b0d")),A=n.n(E);const k=A()(x,[["render",f],["__scopeId","data-v-83ffcd4c"]]);e["default"]=k}}]);
//# sourceMappingURL=export-note-list.9f04ef4e.js.map