(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36817fea"],{"07ac":function(e,t,n){var c=n("23e7"),o=n("6f53").values;c({target:"Object",stat:!0},{values:function(e){return o(e)}})},"1ced":function(e,t,n){"use strict";n("ffd0")},"222b":function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return b})),n.d(t,"g",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return f}));var c=n("1da1"),o=n("5530"),r=(n("96cf"),n("159b"),n("c740"),n("a434"),n("e71f")),a=n("7a23"),i=Object(a["M"])([]),s=Object(r["j"])(),u=Object(r["n"])(Object(r["d"])(s,"CUSTOMER"));Object(r["l"])(u,(function(e){e.docChanges().forEach((function(e){var t=Object(o["a"])({customerID:e.doc.id},e.doc.data()),n=i.findIndex((function(t){return t.customerID===e.doc.id}));"added"===e.type?i.push(t):"modified"===e.type?i.splice(n,1,t):"removed"===e.type&&i.splice(n,1)}))}));var l=function(e){var t=Object(a["N"])({}),n=Object(r["l"])(Object(r["g"])(s,"CUSTOMER",e),function(){var n=Object(c["a"])(regeneratorRuntime.mark((function n(c){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(c.exists()){n.next=2;break}return n.abrupt("return");case 2:t.value=Object(o["a"])({customerID:e},c.data());case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());return{data:t,unSubscribe:n}},d=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,c,o,a,i,u,l,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(r["g"])(s,"CUSTOMER",t),e.next=3,Object(r["h"])(n);case 3:if(c=e.sent,c.exists()){e.next=6;break}return e.abrupt("return",{});case 6:return o=c.data(),a=o.customerName,i=o.phone,u=o.address,l=o.finance,d=o.exportNoteIDList,e.abrupt("return",{customerID:t,customerName:a,phone:i,address:u,finance:l,exportNoteIDList:d});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(r["a"])(Object(r["d"])(s,"CUSTOMER"),{customerName:t.customerName,phone:t.phone,address:t.address,finance:{debt:0,payDebtHistory:[]},exportNoteIDList:[],createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),removedAt:0});case 2:return n=e.sent,e.next=5,d(n.id);case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=Object(r["g"])(s,"CUSTOMER",t),e.next=3,Object(r["q"])(c,{customerName:n.customerName,phone:n.phone,address:n.address,updatedAt:(new Date).getTime()});case 3:return e.next=5,d(c.id);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n,o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(r["o"])(s,function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(c){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.forEach((function(e){var t=e.exportNoteID,n=e.debt;c.update(Object(r["g"])(s,"EXPORTNOTE",t),{"finance.debt":Object(r["k"])(0-n)})})),c.update(Object(r["g"])(s,"CUSTOMER",t),{"finance.debt":Object(r["k"])(0-o),"finance.payDebtHistory":Object(r["c"])({time:(new Date).getTime(),money:o})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),f=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(r["e"])(Object(r["g"])(s,"CUSTOMER",t));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},2422:function(e,t,n){"use strict";n("f0dc")},"2e6d":function(e,t,n){"use strict";n.r(t);var c=n("7a23"),o={class:"title-content"},r={class:"flex items-center mb-2"},a=Object(c["m"])("div",{class:"w-8 flex-none"},"KH :",-1),i={class:"mb-1"},s={class:"flex justify-end mb-4"},u=Object(c["n"])(" Thêm sản phẩm "),l={class:"flex items-center mb-4"},d=Object(c["m"])("div",{class:"w-10 flex-none"},"Ship",-1),b=Object(c["n"])("Seller"),m=Object(c["n"])("Buyer"),p={class:"flex items-center mb-4"},f=Object(c["m"])("div",{class:"w-24 flex-none"},"Shipping Unit",-1),h={class:"flex items-center mb-4"},O=Object(c["m"])("div",{class:"w-14 flex-none"},"KH trả",-1),j=Object(c["n"])(" T.Toán hết "),v={class:"flex items-center mb-4"},x=Object(c["m"])("div",{class:"w-24 flex-none"},"Hình thức",-1),g={class:"flex items-center mb-4"},y=Object(c["m"])("div",{class:"w-24 flex-none"},"Ghi chú",-1),N={class:"flex justify-between"},k=Object(c["n"])(" Back "),S=Object(c["n"])(" Tạo đơn hàng mới "),I=Object(c["n"])(" Cập nhật đơn hàng ");function D(e,t,n,D,P,w){var C=Object(c["R"])("InputSearchCustomer"),M=Object(c["R"])("ExportNoteTableGoods"),R=Object(c["R"])("PlusOutlined"),T=Object(c["R"])("a-button"),E=Object(c["R"])("ModalAddStockOut"),A=Object(c["R"])("a-radio"),U=Object(c["R"])("a-radio-group"),q=Object(c["R"])("a-input"),_=Object(c["R"])("a-textarea");return Object(c["I"])(),Object(c["l"])(c["b"],null,[Object(c["m"])("h1",o,Object(c["V"])("create"===e.$route.params.mode?"Tạo đơn hàng":"")+" "+Object(c["V"])("edit"===e.$route.params.mode?"Sửa đơn hàng":"")+" "+Object(c["V"])("copy"===e.$route.params.mode?"Copy đơn hàng":""),1),Object(c["m"])("div",r,[a,Object(c["o"])(C,{customer:D.exportNote.customer,"onUpdate:customer":t[0]||(t[0]=function(e){return D.exportNote.customer=e}),class:"flex-auto"},null,8,["customer"])]),Object(c["m"])("div",i,[Object(c["o"])(M,{exportNote:D.exportNote,editable:!0,onEditStockOut:w.editStockOut,onRemoveStockOut:w.removeStockOut},null,8,["exportNote","onEditStockOut","onRemoveStockOut"])]),Object(c["m"])("div",s,[Object(c["o"])(T,{onClick:t[1]||(t[1]=function(t){return e.$refs.modalAddStockOut.openModal()})},{icon:Object(c["cb"])((function(){return[Object(c["o"])(R)]})),default:Object(c["cb"])((function(){return[u]})),_:1}),Object(c["o"])(E,{ref:"modalAddStockOut",onActionStockOut:w.actionStockOut},null,8,["onActionStockOut"])]),Object(c["m"])("div",l,[d,Object(c["o"])(U,{value:D.whoPaysShip,"onUpdate:value":t[2]||(t[2]=function(e){return D.whoPaysShip=e}),class:"flex-none"},{default:Object(c["cb"])((function(){return[Object(c["o"])(A,{value:"sellerPaysShip"},{default:Object(c["cb"])((function(){return[b]})),_:1}),Object(c["o"])(A,{value:"buyerPaysShip"},{default:Object(c["cb"])((function(){return[m]})),_:1})]})),_:1},8,["value"]),Object(c["o"])(q,{value:D.shippingCost,"onUpdate:value":t[3]||(t[3]=function(e){return D.shippingCost=e}),valueModifiers:{number:!0},type:"number","addon-after":".000 vnđ",class:"flex-auto"},null,8,["value"])]),Object(c["m"])("div",p,[f,Object(c["o"])(U,{value:D.exportNote.shipping.unit,"onUpdate:value":t[4]||(t[4]=function(e){return D.exportNote.shipping.unit=e}),class:"flex-auto"},{default:Object(c["cb"])((function(){return[(Object(c["I"])(!0),Object(c["l"])(c["b"],null,Object(c["P"])(D.UTILS_EXPORTNOTES.shipping.units,(function(e,t){return Object(c["I"])(),Object(c["j"])(A,{key:t,value:e},{default:Object(c["cb"])((function(){return[Object(c["n"])(Object(c["V"])(e),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["value"])]),Object(c["m"])("div",h,[O,Object(c["o"])(T,{onClick:t[5]||(t[5]=function(e){return D.alreadyPaid=D.exportNote.finance.revenue+D.exportNote.finance.buyerPaysShip})},{default:Object(c["cb"])((function(){return[j]})),_:1}),Object(c["o"])(q,{value:D.alreadyPaid,"onUpdate:value":t[6]||(t[6]=function(e){return D.alreadyPaid=e}),"addon-after":".000 vnđ",type:"number",class:"flex-auto"},null,8,["value"])]),Object(c["m"])("div",v,[x,Object(c["o"])(U,{value:D.exportNote.payment.method,"onUpdate:value":t[7]||(t[7]=function(e){return D.exportNote.payment.method=e}),class:"flex-auto"},{default:Object(c["cb"])((function(){return[(Object(c["I"])(!0),Object(c["l"])(c["b"],null,Object(c["P"])(D.UTILS_EXPORTNOTES.payment.method,(function(e,t){return Object(c["I"])(),Object(c["j"])(A,{key:t,value:e},{default:Object(c["cb"])((function(){return[Object(c["n"])(Object(c["V"])(e),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["value"])]),Object(c["m"])("div",g,[y,Object(c["o"])(_,{value:D.exportNote.other,"onUpdate:value":t[8]||(t[8]=function(e){return D.exportNote.other=e}),placeholder:"...",rows:1},null,8,["value"])]),Object(c["m"])("div",N,[Object(c["o"])(T,{onClick:t[9]||(t[9]=function(t){return e.$router.back()})},{default:Object(c["cb"])((function(){return[k]})),_:1}),Object(c["m"])("div",null,[D.exportNote.exportNoteID?Object(c["k"])("",!0):(Object(c["I"])(),Object(c["j"])(T,{key:0,loading:D.loadingActionExportNote,onClick:w.startCreateExportNote,type:"primary"},{default:Object(c["cb"])((function(){return[S]})),_:1},8,["loading","onClick"])),D.exportNote.exportNoteID?(Object(c["I"])(),Object(c["j"])(T,{key:1,onClick:w.startUpdateExportNote,loading:D.loadingActionExportNote,type:"primary"},{default:Object(c["cb"])((function(){return[I]})),_:1},8,["onClick","loading"])):Object(c["k"])("",!0)])])],64)}var P=n("1da1"),w=n("3835"),C=(n("96cf"),n("07ac"),n("4fad"),n("a9e3"),n("ac1f"),n("1276"),n("b64b"),n("99af"),n("d3b7"),n("25f0"),n("6c02")),M=n("f64c"),R=n("47ce"),T=n("98ae"),E={class:"flex items-center wrapper-input-search-customer"},A={class:"flex-auto relative"},U={class:"customer-name"},q={class:"customer-number"},_={class:"absolute right-2 top-1/4"};function V(e,t,n,o,r,a){var i=Object(c["R"])("InputAutoComplete"),s=Object(c["R"])("CheckCircleOutlined"),u=Object(c["R"])("CloseCircleOutlined"),l=Object(c["R"])("ModalCustomerCreateModify");return Object(c["I"])(),Object(c["l"])("div",E,[Object(c["m"])("div",A,[Object(c["o"])(i,{searchText:n.customer.customerName,dataSource:o.customerArray,filterData:a.logicFilter,onSearching:a.handleSearching,onSelectItem:a.handleSelectItem,style:{position:"relative"}},{each:Object(c["cb"])((function(e){var t=e.item,n=t.customerName,o=t.phone;return[Object(c["m"])("p",U,Object(c["V"])(n),1),Object(c["m"])("p",q,Object(c["V"])(o),1)]})),_:1},8,["searchText","dataSource","filterData","onSearching","onSelectItem"]),Object(c["m"])("div",_,[n.customer.customerID?(Object(c["I"])(),Object(c["j"])(s,{key:0,style:{color:"blue"}})):(Object(c["I"])(),Object(c["j"])(u,{key:1,style:{color:"#f5222d"}}))])]),Object(c["m"])("button",{onClick:t[0]||(t[0]=function(t){return e.$refs.modalCustomerCreateModify.openModal()}),class:"flex-none btn-new-customer"}," Tạo Mới "),Object(c["o"])(l,{ref:"modalCustomerCreateModify",onActionCustomer:a.handleActionCustomer},null,8,["onActionCustomer"])])}var $=n("d34f"),F=n("411c"),G=n("4498"),L=n("b921"),B=n("222b"),K=n("bcc2"),H={props:{customer:Object},components:{InputAutoComplete:G["a"],ModalCustomerCreateModify:L["a"],CheckCircleOutlined:$["a"],CloseCircleOutlined:F["a"]},setup:function(){return{customerArray:B["c"]}},methods:{logicFilter:function(e,t){return Object(K["c"])(e.customerName,this.customer.customerName)},handleSearching:function(e){this.$emit("update:customer",{customerID:"",customerName:e})},handleSelectItem:function(e){var t=e.value;e.key;this.$emit("update:customer",{customerID:t.customerID,customerName:t.customerName})},handleActionCustomer:function(e){this.$emit("update:customer",{customerID:e.customerID,customerName:e.customerName})}}},X=(n("1ced"),n("6b0d")),Y=n.n(X);const J=Y()(H,[["render",V],["__scopeId","data-v-137be3ca"]]);var z=J,Q=n("f7db"),W={class:"flex items-center mb-2"},Z=Object(c["m"])("div",{class:"w-20 flex-none"},"Sản phẩm",-1),ee={class:"flex items-center mb-2"},te=Object(c["m"])("div",{class:"w-20 flex-none"},null,-1),ne={class:"flex-auto"},ce={class:"flex"},oe=Object(c["m"])("div",{class:"w-10"},"HSD",-1),re=Object(c["m"])("div",{class:"w-4"},":",-1),ae={class:"flex"},ie=Object(c["m"])("div",{class:"w-10"},"Tồn",-1),se=Object(c["m"])("div",{class:"w-4"},":",-1),ue={class:"flex items-center mb-2"},le=Object(c["m"])("div",{class:"w-20 flex-none"},"Số lượng",-1),de={class:"flex items-center mb-2"},be=Object(c["m"])("div",{class:"w-20 flex-none"},"Giá",-1),me={class:"flex mb-1"},pe=Object(c["m"])("div",{class:"w-16"},"Nhập",-1),fe={class:"flex mb-1"},he=Object(c["m"])("div",{class:"w-16"},"Sỉ",-1),Oe={class:"flex"},je=Object(c["m"])("div",{class:"w-16"},"Lẻ",-1),ve={class:"flex items-center mb-2"},xe=Object(c["m"])("div",{class:"w-20 flex-none"},"Giảm giá",-1),ge=Object(c["n"])(".000"),ye=Object(c["n"])("%"),Ne={class:"flex items-center mb-2"},ke=Object(c["m"])("div",{class:"w-20 flex-none"},"Bán",-1),Se={class:"flex items-center mb-2"},Ie=Object(c["m"])("div",{class:"w-20 flex-none"},"Tổng",-1);function De(e,t,n,o,r,a){var i=Object(c["R"])("InputFilterStockOut"),s=Object(c["R"])("a-input"),u=Object(c["R"])("a-radio"),l=Object(c["R"])("a-radio-group"),d=Object(c["R"])("a-select-option"),b=Object(c["R"])("a-select"),m=Object(c["R"])("a-modal");return Object(c["I"])(),Object(c["j"])(m,{visible:o.visibleModal,"onUpdate:visible":t[5]||(t[5]=function(e){return o.visibleModal=e}),afterClose:a.refreshModal,onOk:a.handleModalStockOutOk,"ok-text":o.isEditMode?"Cập nhật hàng":"Thêm sản phẩm",title:o.isEditMode?"Cập nhật hàng":"Thêm sản phẩm",style:{top:"50px"},width:"600px"},{default:Object(c["cb"])((function(){return[Object(c["m"])("form",null,[Object(c["m"])("div",W,[Z,Object(c["o"])(i,{searchText:o.goods.goodsName,"onUpdate:searchText":t[0]||(t[0]=function(e){return o.goods.goodsName=e}),disabled:!!o.isEditMode,onSelectItem:a.handleSelectGoods,onSearching:a.handleSearching},null,8,["searchText","disabled","onSelectItem","onSearching"])]),Object(c["m"])("div",ee,[te,Object(c["m"])("div",ne,[Object(c["m"])("div",ce,[oe,re,Object(c["n"])(" "+Object(c["V"])(a.formatDateTime(o.goods.expiryDate)),1)]),Object(c["m"])("div",ae,[ie,se,Object(c["n"])(" "+Object(c["V"])(o.goods.quantity),1)])])]),Object(c["m"])("div",ue,[le,Object(c["o"])(s,{value:o.quantity,"onUpdate:value":t[1]||(t[1]=function(e){return o.quantity=e}),valueModifiers:{number:!0},type:"number","addon-after":o.goods.unit,class:"flex-auto"},null,8,["value","addon-after"])]),Object(c["m"])("div",de,[be,Object(c["o"])(l,{value:o.expectedPrice,"onUpdate:value":t[2]||(t[2]=function(e){return o.expectedPrice=e}),class:"flex-col"},{default:Object(c["cb"])((function(){return[Object(c["m"])("div",me,[pe,Object(c["o"])(u,{value:o.goods.costPrice},{default:Object(c["cb"])((function(){return[Object(c["n"])(Object(c["V"])(o.goods.costPrice),1)]})),_:1},8,["value"])]),Object(c["m"])("div",fe,[he,Object(c["o"])(u,{value:o.goods.wholesalePrice},{default:Object(c["cb"])((function(){return[Object(c["n"])(Object(c["V"])(o.goods.wholesalePrice),1)]})),_:1},8,["value"])]),Object(c["m"])("div",Oe,[je,Object(c["o"])(u,{value:o.goods.retailPrice},{default:Object(c["cb"])((function(){return[Object(c["n"])(Object(c["V"])(o.goods.retailPrice),1)]})),_:1},8,["value"])])]})),_:1},8,["value"])]),Object(c["m"])("div",ve,[xe,Object(c["o"])(s,{class:"flex-auto",value:o.discount.number,"onUpdate:value":t[3]||(t[3]=function(e){return o.discount.number=e}),valueModifiers:{number:!0},type:"number"},null,8,["value"]),Object(c["o"])(b,{value:o.discount.type,"onUpdate:value":t[4]||(t[4]=function(e){return o.discount.type=e}),style:{"font-size":"16px"}},{default:Object(c["cb"])((function(){return[Object(c["o"])(d,{value:"vnd"},{default:Object(c["cb"])((function(){return[ge]})),_:1}),Object(c["o"])(d,{value:"percent"},{default:Object(c["cb"])((function(){return[ye]})),_:1})]})),_:1},8,["value"])]),Object(c["m"])("div",Ne,[ke,Object(c["m"])("div",null,Object(c["V"])(a.formatNumber(a.actualPrice)),1)]),Object(c["m"])("div",Se,[Ie,Object(c["m"])("div",null,Object(c["V"])(a.formatNumber(a.totalPrice)),1)])])]})),_:1},8,["visible","afterClose","onOk","ok-text","title"])}n("7db0");var Pe=n("b65c"),we={class:"w-full relative"},Ce={class:"font-bold m-0"},Me={class:"m-0"},Re={class:"absolute right-2 top-1/4"};function Te(e,t,n,o,r,a){var i=Object(c["R"])("InputAutoComplete"),s=Object(c["R"])("CheckCircleOutlined"),u=Object(c["R"])("CloseCircleOutlined");return Object(c["I"])(),Object(c["l"])("div",we,[Object(c["o"])(i,{searchText:n.searchText,dataSource:a.convertGoodArray,filterData:a.logicFilter,disabled:n.disabled,onSearching:a.handleSearching,onSelectItem:a.handleSelectItem},{each:Object(c["cb"])((function(e){var t=e.item,n=t.goodsName,o=t.unit,r=t.quantity,i=t.expiryDate,s=t.retailPrice;return[Object(c["m"])("p",Ce,Object(c["V"])(n),1),Object(c["m"])("p",Me,Object(c["V"])(a.formatDateTime(Number(i)))+" - "+Object(c["V"])(a.formatNumber(s||0))+"/"+Object(c["V"])(o)+" - "+Object(c["V"])(r),1)]})),_:1},8,["searchText","dataSource","filterData","disabled","onSearching","onSelectItem"]),Object(c["m"])("div",Re,[o.goodsID?(Object(c["I"])(),Object(c["j"])(s,{key:0,style:{color:"blue"}})):(Object(c["I"])(),Object(c["j"])(u,{key:1,style:{color:"#f5222d"}}))])])}var Ee=n("5530"),Ae=n("15fd"),Ue=(n("159b"),n("4e82"),["stockAvail"]),qe={props:{searchText:String,disabled:{type:Boolean,default:function(){return!1}}},components:{InputAutoComplete:G["a"],CheckCircleOutlined:$["a"],CloseCircleOutlined:F["a"]},setup:function(){return{goodsArray:Pe["c"],goodsID:Object(c["N"])("")}},computed:{convertGoodArray:function(){var e=[];return this.goodsArray.forEach((function(t){var n=t.stockAvail,c=Object(Ae["a"])(t,Ue);0===Object.keys(n).length?e.push(Object(Ee["a"])({},c)):Object.entries(n).forEach((function(t){var n=Object(w["a"])(t,2),o=n[0],r=n[1];e.push(Object(Ee["a"])({expiryDate:o.split("-")[0],costPrice:o.split("-")[1],quantity:r.quantity},c))}))})),e.sort((function(e,t){return e.goodsName>t.goodsName?1:e.goodsName<t.goodsName?-1:0})),e}},methods:{handleSearching:function(e){this.$emit("update:searchText",e),this.$emit("searching",e),this.goodsID=""},handleSelectItem:function(e){e.key;var t=e.value;this.$emit("update:searchText",t.goodsName),this.$emit("selectItem",{goodsID:t.goodsID,expiryDate:t.expiryDate,costPrice:t.costPrice}),this.goodsID=t.goodsID},logicFilter:function(e,t){return Object(K["c"])(e.goodsName,this.searchText)},formatDateTime:function(e){return Object(K["a"])(e,"DD/MM/YY")},formatNumber:function(e){return Object(K["b"])(e,3)}}};const _e=Y()(qe,[["render",Te]]);var Ve=_e,$e={components:{InputFilterStockOut:Ve},setup:function(){return{isEditMode:Object(c["N"])(""),visibleModal:Object(c["N"])(!1),goods:Object(c["N"])({goodsID:"",goodsName:"",group:"-",unit:"-",retailPrice:"",wholesalePrice:"",expiryDate:"",quantity:"-",costPrice:""}),expectedPrice:Object(c["N"])("-"),quantity:Object(c["N"])(""),discount:Object(c["N"])({number:"",type:"vnd"}),goodsArray:Pe["c"]}},computed:{actualPrice:function(){return"vnd"===this.discount.type?this.expectedPrice-this.discount.number:this.expectedPrice*(1-this.discount.number/100)},totalPrice:function(){return this.actualPrice*this.quantity}},methods:{setDataModal:function(e){var t,n,c=e.infoGoods,o=e.infoSell;this.goods.goodsID=c.goodsID||"",this.goods.goodsName=c.goodsName||"",this.goods.group=c.group||"",this.goods.unit=c.unit||"",this.goods.expiryDate=Number(c.expiryDate),this.goods.quantity=c.quantity||0,this.goods.costPrice=c.costPrice||0,this.goods.retailPrice=c.retailPrice||0,this.goods.wholesalePrice=c.wholesalePrice||0,this.expectedPrice=o.expectedPrice||"-",this.quantity=o.quantity||0,this.discount.number=(null===(t=o.discount)||void 0===t?void 0:t.number)||"0",this.discount.type=(null===(n=o.discount)||void 0===n?void 0:n.type)||"vnd"},getGoodsByBatch:function(e,t,n){var c,o,r=this.goodsArray.find((function(t){return t.goodsID===e})),a="".concat(t,"-").concat(n);return{goodsID:e,goodsName:r.goodsName,group:r.group,unit:r.unit,expiryDate:t,costPrice:n,quantity:(null===(c=r.stockAvail)||void 0===c||null===(o=c[a])||void 0===o?void 0:o.quantity)||"",retailPrice:r.retailPrice,wholesalePrice:r.wholesalePrice}},openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.infoGoods,n=e.infoSell,c=e.isEditMode;this.visibleModal=!0,this.isEditMode=c||"",(t||n)&&this.setDataModal({infoSell:n,infoGoods:this.getGoodsByBatch(t.goodsID,t.expiryDate,t.costPrice)})},refreshModal:function(){this.setDataModal({infoGoods:{},infoSell:{}})},handleSearching:function(e){this.setDataModal({infoGoods:{goodsName:e},infoSell:{}})},handleSelectGoods:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.goodsID,n=e.expiryDate,c=e.costPrice,o=this.goodsArray.find((function(e){return e.goodsID===t}));this.setDataModal({infoGoods:this.getGoodsByBatch(t,n,c),infoSell:{expectedPrice:o.retailPrice}})},notify:function(e){this.$notification.open({message:"Lỗi !!!",description:e,placement:"topRight",duration:2})},checkValidation:function(){return this.goods.goodsID?!(!this.quantity||this.quantity>this.goods.quantity)||(this.notify("Số lượng sản phẩm phải trong khoảng: từ 1 đến ".concat(this.goods.quantity)),!1):(this.notify("Bạn cần phải nhập tên sản phẩm !"),!1)},handleModalStockOutOk:function(){if(this.checkValidation()){var e={goodsID:this.goods.goodsID,expiryDate:this.goods.expiryDate,costPrice:this.goods.costPrice,quantity:this.quantity,expectedPrice:this.expectedPrice,actualPrice:this.actualPrice};this.$emit("actionStockOut",{isEditMode:this.isEditMode,stock:e}),M["a"].success("Đã thêm ".concat(this.goods.goodsName," với số lượng ").concat(this.goods.quantity," vào phiếu")),this.visibleModal=!1}},formatDateTime:function(e){return Object(K["a"])(e,"DD/MM/YY")},formatNumber:function(e){return Object(K["b"])(e,3)}}};const Fe=Y()($e,[["render",De]]);var Ge=Fe,Le=n("c9d9"),Be={components:{InputSearchCustomer:z,ModalAddStockOut:Ge,PlusOutlined:R["a"],ExportNoteTableGoods:Q["a"]},setup:function(){var e=Object(C["c"])(),t=Object(c["N"])({exportNoteID:"",customer:{customerID:"",customerName:""},stockOut:{},shipping:{unit:""},payment:{method:""},finance:{revenue:0,profit:0,sellerPaysShip:0,buyerPaysShip:0,debt:0},other:"",status:""}),n=Object(c["N"])("buyerPaysShip"),o=Object(c["N"])(0),r=Object(c["N"])(0);return e.params.id&&Object(T["d"])(e.params.id).then((function(c){t.value=c,"copy"===e.params.mode&&(t.value.exportNoteID=""),n.value=c.finance.buyerPaysShip?"buyerPaysShip":"sellerPaysShip",o.value=c.finance.sellerPaysShip||c.finance.buyerPaysShip,r.value=c.finance.revenue+c.finance.buyerPaysShip-c.finance.debt})).catch((function(e){return console.log(e)})),{exportNote:t,loadingActionExportNote:Object(c["N"])(!1),UTILS_EXPORTNOTES:Le["a"],whoPaysShip:n,shippingCost:o,alreadyPaid:r}},watch:{"exportNote.stockOut":{handler:function(e,t){var n=Object.values(e).reduce((function(e,t){var n=Object.entries(t).reduce((function(e,t){var n=Object(w["a"])(t,2),c=n[0],o=n[1],r=o.quantity*Number(c.split("-")[1]);return e+r}),0);return e+n}),0),c=Object.values(e).reduce((function(e,t){var n=Object.values(t).reduce((function(e,t){var n=t.quantity*t.actualPrice;return e+n}),0);return e+n}),0);this.exportNote.finance.revenue=c,this.exportNote.finance.profit=c-n,this.exportNote.finance.debt=this.exportNote.finance.revenue+this.exportNote.finance.buyerPaysShip-this.alreadyPaid},deep:!0},shippingCost:function(e,t){this.exportNote.finance[this.whoPaysShip]=e,this.exportNote.finance.debt=this.exportNote.finance.revenue+this.exportNote.finance.buyerPaysShip-this.alreadyPaid},whoPaysShip:function(e,t){this.exportNote.finance[t]=0,this.exportNote.finance[e]=this.shippingCost,this.exportNote.finance.debt=this.exportNote.finance.revenue+this.exportNote.finance.buyerPaysShip-this.alreadyPaid},alreadyPaid:function(e,t){this.exportNote.finance.debt=this.exportNote.finance.revenue+this.exportNote.finance.buyerPaysShip-e}},methods:{editStockOut:function(e){var t=e.goodsID,n=e.batchKey,c=this.exportNote.stockOut[t][n],o=c.expectedPrice,r=c.actualPrice,a=c.quantity,i=Number(n.split("-")[0]),s=Number(n.split("-")[1]);this.$refs.modalAddStockOut.openModal({infoGoods:{goodsID:t,expiryDate:i,costPrice:s},infoSell:{expectedPrice:o,quantity:a,actualPrice:r,discount:{number:o-r,type:"vnd"}},isEditMode:n})},removeStockOut:function(e){var t=e.goodsID,n=e.batchKey;delete this.exportNote.stockOut[t][n],0===Object.keys(this.exportNote.stockOut[t]).length&&delete this.exportNote.stockOut[t][n]},actionStockOut:function(e){var t=e.isEditMode,n=e.stock,c=n.goodsID,o=n.expiryDate,r=n.quantity,a=n.costPrice,i=n.expectedPrice,s=n.actualPrice;t&&delete this.exportNote.stockOut[c][t],this.exportNote.stockOut[c]||(this.exportNote.stockOut[c]={});var u="".concat(o,"-").concat(a);this.exportNote.stockOut[c][u]||(this.exportNote.stockOut[c][u]={}),this.exportNote.stockOut[c][u]={quantity:(this.exportNote.stockOut[c][u].quantity||0)+r,expectedPrice:i,actualPrice:s}},notify:function(e){this.$notification.open({message:"Lỗi !!!",description:e,placement:"topRight",duration:2})},checkValidation:function(){return this.exportNote.customer.customerID?0!==Object.keys(this.exportNote.stockOut).length||(this.notify("Đơn hàng cần có ít nhất 1 sản phẩm !"),!1):(this.notify("Đơn hàng cần chọn khách hàng cụ thể !"),!1)},startCreateExportNote:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.checkValidation()){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e.loadingActionExportNote=!0,t.next=6,Object(T["a"])(e.exportNote);case 6:n=t.sent,M["a"].success("Tạo đơn hàng thành công !!!",2),e.$router.push({name:"ExportNote Details",params:{id:n}}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),M["a"].error(t.t0.toString(),10);case 14:return t.prev=14,e.loadingActionExportNote=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[2,11,14,17]])})))()},startUpdateExportNote:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.loadingActionExportNote=!0,t.next=4,Object(T["k"])(e.exportNote.exportNoteID,e.exportNote);case 4:n=t.sent,M["a"].success("Cập nhật đơn hàng thành công !!!",2),e.$router.push({name:"ExportNote Details",params:{id:n}}),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),console.error(t.t0),M["a"].error(t.t0.toString(),10);case 13:return t.prev=13,e.loadingActionExportNote=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[0,9,13,16]])})))()}}};const Ke=Y()(Be,[["render",D]]);t["default"]=Ke},4498:function(e,t,n){"use strict";var c=n("7a23"),o={class:"my-input-autocomplete"},r=["value","disabled"],a={key:0,class:"select-filter"},i=["onClick"],s={class:"item-json"};function u(e,t,n,u,l,d){var b=Object(c["S"])("click-outside");return Object(c["db"])((Object(c["I"])(),Object(c["l"])("div",o,[Object(c["m"])("input",{value:n.searchText,onInput:t[0]||(t[0]=function(){return d.handleChangeInput&&d.handleChangeInput.apply(d,arguments)}),onKeydown:t[1]||(t[1]=function(){return d.handleKeydown&&d.handleKeydown.apply(d,arguments)}),type:"text",class:"input-filter",placeholder:"Search...",disabled:n.disabled},null,40,r),u.isSearching?(Object(c["I"])(),Object(c["l"])("div",a,[(Object(c["I"])(!0),Object(c["l"])(c["b"],null,Object(c["P"])(d.convertData,(function(t,n,o){return Object(c["I"])(),Object(c["l"])("div",{key:o,class:Object(c["y"])({active:o==u.indexFocus,"item-search":!0}),onClick:Object(c["eb"])((function(e){return d.handleSelectItem(o)}),["prevent"])},[Object(c["Q"])(e.$slots,"each",{item:t,key:n,index:o},(function(){return[Object(c["m"])("div",s,Object(c["V"])(o)+" - "+Object(c["V"])(n)+" - "+Object(c["V"])(JSON.stringify(t)),1)]}))],10,i)})),128))])):Object(c["k"])("",!0)],512)),[[b,d.handleClickOutside]])}var l=n("ade3"),d=n("3835"),b=n("2909"),m=(n("99af"),n("d81d"),n("4de4"),n("4fad"),n("b64b"),{props:{searchText:String,dataSource:{type:[Array,Object]},filterData:Function,disabled:{type:Boolean,default:function(){return!1}}},setup:function(){return{indexFocus:Object(c["N"])(-1),isSearching:Object(c["N"])(!1)}},computed:{convertData:function(){var e=this;return Object.assign.apply(Object,[{}].concat(Object(b["a"])(Object.entries(this.dataSource).filter((function(t){var n=Object(d["a"])(t,2),c=(n[0],n[1]);return e.filterData(c,e.searchText)})).map((function(e){var t=Object(d["a"])(e,2),n=t[0],c=t[1];return Object(l["a"])({},n,c)})))))},dataLeng:function(){return Object.keys(this.convertData).length}},methods:{handleChangeInput:function(e){this.$emit("update:searchText",e.target.value),this.$emit("searching",e.target.value),this.indexFocus=-1,e.target.value?this.isSearching=!0:this.isSearching=!1},handleKeydown:function(e){40===e.keyCode&&(this.indexFocus+=1,this.indexFocus>=this.dataLeng&&(this.indexFocus=0)),38===e.keyCode&&(this.indexFocus-=1,this.indexFocus<0&&(this.indexFocus=this.dataLeng-1)),13===e.keyCode&&this.handleSelectItem(this.indexFocus)},handleSelectItem:function(e){this.indexFocus=-1;var t=Object(d["a"])(Object.entries(this.convertData)[e],2),n=t[0],c=t[1];this.$emit("selectItem",{value:c,key:n}),this.closeSelectItem()},handleClickOutside:function(){this.indexFocus=-1,this.closeSelectItem()},closeSelectItem:function(){var e=this;this.$nextTick((function(){e.isSearching=!1}))}}}),p=(n("2422"),n("6b0d")),f=n.n(p);const h=f()(m,[["render",u]]);t["a"]=h},b921:function(e,t,n){"use strict";var c=n("7a23"),o={class:"flex items-center mb-2"},r=Object(c["m"])("div",{class:"w-20 flex-none"},"Name",-1),a={class:"flex items-center mb-2"},i=Object(c["m"])("div",{class:"w-20 flex-none"},"Phone",-1),s={class:"flex items-center mb-2"},u=Object(c["m"])("div",{class:"w-20 flex-none"},"Address",-1);function l(e,t,n,l,d,b){var m=Object(c["R"])("a-input"),p=Object(c["R"])("a-modal");return Object(c["I"])(),Object(c["j"])(p,{visible:l.visibleModal,"onUpdate:visible":t[3]||(t[3]=function(e){return l.visibleModal=e}),width:"900px",title:l.customer.customerID?"Update Customer":"Create New Customer","confirm-loading":l.confirmModalLoading,afterClose:b.refreshModal,onOk:b.handleModalCustomerOk},{default:Object(c["cb"])((function(){return[Object(c["m"])("form",null,[Object(c["m"])("div",o,[r,Object(c["o"])(m,{value:l.customer.customerName,"onUpdate:value":t[0]||(t[0]=function(e){return l.customer.customerName=e}),class:"flex-auto"},null,8,["value"])]),Object(c["m"])("div",a,[i,Object(c["o"])(m,{value:l.customer.phone,"onUpdate:value":t[1]||(t[1]=function(e){return l.customer.phone=e}),class:"flex-auto"},null,8,["value"])]),Object(c["m"])("div",s,[u,Object(c["o"])(m,{value:l.customer.address,"onUpdate:value":t[2]||(t[2]=function(e){return l.customer.address=e}),class:"flex-auto"},null,8,["value"])])])]})),_:1},8,["visible","title","confirm-loading","afterClose","onOk"])}var d=n("1da1"),b=(n("96cf"),n("222b")),m={setup:function(){return{visibleModal:Object(c["N"])(!1),confirmModalLoading:Object(c["N"])(!1),customer:Object(c["N"])({customerID:"",customerName:"",phone:"",address:""})}},methods:{openModal:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function n(){var c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.visibleModal=!0,!e){n.next=9;break}return n.next=4,Object(b["e"])(e);case 4:c=n.sent,t.customer.customerID=c.customerID,t.customer.customerName=c.customerName,t.customer.phone=c.phone,t.customer.address=c.address;case 9:case"end":return n.stop()}}),n)})))()},refreshModal:function(){this.customer.customerID="",this.customer.customerName="",this.customer.phone="",this.customer.address="",this.confirmModalLoading=!1},handleModalCustomerOk:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.confirmModalLoading=!0,n={customerName:e.customer.customerName,phone:e.customer.phone,address:e.customer.address},t.prev=2,e.customer.customerID){t.next=10;break}return t.next=6,Object(b["a"])(n);case 6:c=t.sent,e.$emit("actionCustomer",c),t.next=14;break;case 10:return t.next=12,Object(b["g"])(e.customer.customerID,n);case 12:o=t.sent,e.$emit("actionCustomer",o);case 14:e.visibleModal=!1,t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](2),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[2,17]])})))()}}},p=n("6b0d"),f=n.n(p);const h=f()(m,[["render",l]]);t["a"]=h},f0dc:function(e,t,n){},ffd0:function(e,t,n){}}]);
//# sourceMappingURL=chunk-36817fea.f0576fc5.js.map