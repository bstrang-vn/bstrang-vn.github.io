(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f986eae"],{"04d1":function(e,t,n){var r=n("342f"),c=r.match(/firefox\/(\d+)/i);e.exports=!!c&&+c[1]},"222b":function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"g",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return O}));var r=n("1da1"),c=n("5530"),a=(n("96cf"),n("159b"),n("c740"),n("a434"),n("e71f")),o=n("7a23"),u=Object(o["M"])([]),i=Object(a["j"])(),s=Object(a["n"])(Object(a["d"])(i,"CUSTOMER"));Object(a["l"])(s,(function(e){e.docChanges().forEach((function(e){var t=Object(c["a"])({customerID:e.doc.id},e.doc.data()),n=u.findIndex((function(t){return t.customerID===e.doc.id}));"added"===e.type?u.push(t):"modified"===e.type?u.splice(n,1,t):"removed"===e.type&&u.splice(n,1)}))}));var b=function(e){var t=Object(o["N"])({}),n=Object(a["l"])(Object(a["g"])(i,"CUSTOMER",e),function(){var n=Object(r["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.exists()){n.next=2;break}return n.abrupt("return");case 2:t.value=Object(c["a"])({customerID:e},r.data());case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());return{data:t,unSubscribe:n}},d=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r,c,o,u,s,b,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(a["g"])(i,"CUSTOMER",t),e.next=3,Object(a["h"])(n);case 3:if(r=e.sent,r.exists()){e.next=6;break}return e.abrupt("return",{});case 6:return c=r.data(),o=c.customerName,u=c.phone,s=c.address,b=c.finance,d=c.exportNoteIDList,e.abrupt("return",{customerID:t,customerName:o,phone:u,address:s,finance:b,exportNoteIDList:d});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a["a"])(Object(a["d"])(i,"CUSTOMER"),{customerName:t.customerName,phone:t.phone,address:t.address,finance:{debt:0,payDebtHistory:[]},exportNoteIDList:[],createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),removedAt:0});case 2:return n=e.sent,e.next=5,d(n.id);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=Object(a["g"])(i,"CUSTOMER",t),e.next=3,Object(a["q"])(r,{customerName:n.customerName,phone:n.phone,address:n.address,updatedAt:(new Date).getTime()});case 3:return e.next=5,d(r.id);case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n,c){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a["o"])(i,function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.forEach((function(e){var t=e.exportNoteID,n=e.debt;r.update(Object(a["g"])(i,"EXPORTNOTE",t),{"finance.debt":Object(a["k"])(0-n)})})),r.update(Object(a["g"])(i,"CUSTOMER",t),{"finance.debt":Object(a["k"])(0-c),"finance.payDebtHistory":Object(a["c"])({time:(new Date).getTime(),money:c})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),O=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(a["e"])(Object(a["g"])(i,"CUSTOMER",t));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},"4e82":function(e,t,n){"use strict";var r=n("23e7"),c=n("59ed"),a=n("7b0b"),o=n("07fa"),u=n("577e"),i=n("d039"),s=n("addb"),b=n("a640"),d=n("04d1"),l=n("d998"),m=n("2d00"),f=n("512c"),O=[],p=O.sort,j=i((function(){O.sort(void 0)})),h=i((function(){O.sort(null)})),v=b("sort"),x=!i((function(){if(m)return m<70;if(!(d&&d>3)){if(l)return!0;if(f)return f<603;var e,t,n,r,c="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)O.push({k:t+r,v:n})}for(O.sort((function(e,t){return t.v-e.v})),r=0;r<O.length;r++)t=O[r].k.charAt(0),c.charAt(c.length-1)!==t&&(c+=t);return"DGBEFHACIJK"!==c}})),g=j||!h||!v||!x,w=function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:u(t)>u(n)?1:-1}};r({target:"Array",proto:!0,forced:g},{sort:function(e){void 0!==e&&c(e);var t=a(this);if(x)return void 0===e?p.call(t):p.call(t,e);var n,r,u=[],i=o(t);for(r=0;r<i;r++)r in t&&u.push(t[r]);u=s(u,w(e)),n=u.length,r=0;while(r<n)t[r]=u[r++];while(r<i)delete t[r++];return t}})},"512c":function(e,t,n){var r=n("342f"),c=r.match(/AppleWebKit\/(\d+)\./);e.exports=!!c&&+c[1]},"7db0":function(e,t,n){"use strict";var r=n("23e7"),c=n("b727").find,a=n("44d2"),o="find",u=!0;o in[]&&Array(1)[o]((function(){u=!1})),r({target:"Array",proto:!0,forced:u},{find:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0)}}),a(o)},"98ae":function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return k})),n.d(t,"j",(function(){return O})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return x})),n.d(t,"k",(function(){return w})),n.d(t,"g",(function(){return g})),n.d(t,"b",(function(){return D}));var r=n("3835"),c=n("1da1"),a=n("5530"),o=(n("96cf"),n("159b"),n("c740"),n("a434"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("b64b"),n("4fad"),n("99af"),n("e71f")),u=n("7a23"),i=n("bcc2"),s=(new Date).getFullYear(),b=(new Date).getMonth()+1,d=new Date(s+"-"+b).getTime(),l=Object(u["M"])([]),m=Object(o["j"])(),f=Object(o["n"])(Object(o["d"])(m,"EXPORTNOTE"),Object(o["r"])("updatedAt",">",d),Object(o["m"])("updatedAt","asc"));Object(o["l"])(f,(function(e){e.docChanges().forEach((function(e){var t=Object(a["a"])(Object(a["a"])({},e.doc.data()),{},{exportNoteID:e.doc.id}),n=l.findIndex((function(t){return t.exportNoteID===e.doc.id}));"added"===e.type?l.unshift(t):"modified"===e.type?l.splice(n,1,t):"removed"===e.type&&l.splice(n,1)}))}));var O=function(e){var t=Object(u["N"])({}),n=Object(o["l"])(Object(o["g"])(m,"EXPORTNOTE",e),function(){var n=Object(c["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.exists()){n.next=2;break}return n.abrupt("return");case 2:t.value=Object(a["a"])(Object(a["a"])({},r.data()),{},{exportNoteID:e});case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());return{data:t,unSubscribe:n}},p=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("ID must not be empty");case 2:return n=Object(o["g"])(m,"EXPORTNOTE",t),e.next=5,Object(o["h"])(n);case 5:if(r=e.sent,r.exists()){e.next=8;break}throw new Error("ExportNote not found !!!");case 8:return e.abrupt("return",Object(a["a"])(Object(a["a"])({},r.data()),{},{exportNoteID:r.id}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.map((function(e){return Object(o["h"])(Object(o["g"])(m,"EXPORTNOTE",e))})),e.next=3,Promise.all(n);case 3:return r=e.sent,e.abrupt("return",r.map((function(e){return Object(a["a"])(Object(a["a"])({},e.data()),{},{exportNoteID:e.id})})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(i["a"])(new Date,"YY-MM-DD-HH-mm-ss"),r=Object(o["g"])(m,"EXPORTNOTE",n),e.next=4,Object(o["h"])(r);case 4:if(c=e.sent,!c.exists()){e.next=7;break}throw new Error("Phiếu nhập này đã tồn tại");case 7:return e.next=9,Object(o["p"])(r,Object(a["a"])(Object(a["a"])({},t),{},{status:"Pending",createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),removedAt:0}));case 9:return e.abrupt("return",r.id);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["o"])(m,function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(n){var c,a,u,i,s,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=Object(o["g"])(m,"EXPORTNOTE",t),e.next=3,n.get(c);case 3:if(a=e.sent,a.exists()){e.next=6;break}throw new Error("Document not exists");case 6:if(u=a.data(),i=Object.assign({},u),"Pending"===i.status){e.next=9;break}throw new Error("Notes is not in pending status");case 9:return s=Object.keys(i.stockOut).map((function(e){return n.get(Object(o["g"])(m,"WAREHOUSE",e))})),e.next=12,Promise.all(s);case 12:b=e.sent,b.forEach((function(e){var c=e.data()||{},a=c.stockAvail,u=c.goodsName;Object.entries(i.stockOut[e.id]).forEach((function(e){var t=Object(r["a"])(e,2),n=t[0],c=t[1].quantity;if(!a[n])throw new Error("".concat(u," with ").concat(n," are not available in warehouse"));if(a[n].quantity<c)throw new Error("".concat(u," available is ").concat(a[n].quantity,". But, you have just export ").concat(c));a[n].quantity!==c?a[n].quantity-=c:delete a[n]})),n.update(Object(o["g"])(m,"WAREHOUSE",e.id),{stockAvail:a,exportNoteIDList:Object(o["c"])(t)})})),n.update(Object(o["g"])(m,"CUSTOMER",i.customer.customerID),{exportNoteIDList:Object(o["c"])(t),"finance.debt":Object(o["k"])(i.finance.debt)}),n.update(c,{status:"Success",updatedAt:(new Date).getTime()});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["o"])(m,function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(n){var c,u,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=Object(o["g"])(m,"EXPORTNOTE",t),e.next=3,n.get(c);case 3:if(u=e.sent,u.exists()){e.next=6;break}throw new Error("Document not exists");case 6:if(i=u.data(),s=Object.assign({},i),"Success"===s.status){e.next=9;break}throw new Error("Notes is not in success status");case 9:Object.entries(s.stockOut).forEach((function(e){var c=Object(r["a"])(e,2),u=c[0],i=c[1],s={};Object.entries(i).forEach((function(e){var t=Object(r["a"])(e,2),n=t[0],c=t[1].quantity,a="stockAvail."+n+".quantity";s[a]=Object(o["k"])(c)})),n.update(Object(o["g"])(m,"WAREHOUSE",u),Object(a["a"])(Object(a["a"])({},s),{},{exportNoteIDList:Object(o["b"])(t)}))})),n.update(Object(o["g"])(m,"CUSTOMER",s.customer.customerID),{exportNoteIDList:Object(o["b"])(t),"finance.debt":Object(o["k"])(0-s.finance.debt)}),n.update(c,{status:"Pending",updatedAt:(new Date).getTime()});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["o"])(m,function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(r){var c,a,u,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=Object(o["g"])(m,"EXPORTNOTE",t),e.next=3,r.get(c);case 3:if(a=e.sent,a.exists()){e.next=6;break}throw new Error("Document not exists");case 6:if(u=a.data(),i=Object.assign({},u),"Success"===i.status){e.next=9;break}throw new Error("Notes is not in success status");case 9:r.update(c,{"finance.debt":Object(o["k"])(0-n)}),r.update(Object(o["g"])(m,"CUSTOMER",i.customer.customerID),{"finance.debt":Object(o["k"])(0-n)});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("ID must not be empty");case 2:return r=Object(o["g"])(m,"EXPORTNOTE",t),e.next=5,Object(o["h"])(r);case 5:if(c=e.sent,c.exists()){e.next=8;break}throw new Error("ExportNote not found !!!");case 8:if("Pending"===c.data().status){e.next=10;break}throw new Error("Notes is not in pending status");case 10:return e.next=12,Object(o["q"])(r,Object(a["a"])(Object(a["a"])({},n),{},{updatedAt:(new Date).getTime()}));case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("ID must not be empty");case 2:return n=Object(o["g"])(m,"EXPORTNOTE",t),e.next=5,Object(o["h"])(n);case 5:if(r=e.sent,r.exists()){e.next=8;break}throw new Error("ExportNote not found !!!");case 8:if("Pending"===r.data().status){e.next=10;break}throw new Error("Notes is not in pending status");case 10:return e.next=12,Object(o["e"])(Object(o["g"])(m,"EXPORTNOTE",t));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(o["n"])(Object(o["d"])(m,"EXPORTNOTE"),Object(o["r"])("customer.customerID","==",t),Object(o["r"])("status","==","Success"),Object(o["r"])("finance.debt",">",0)),e.next=3,Object(o["i"])(n);case 3:return r=e.sent,c=[],r.forEach((function(e){c.push(Object(a["a"])({exportNoteID:e.id},e.data()))})),e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},addb:function(e,t){var n=Math.floor,r=function(e,t){var o=e.length,u=n(o/2);return o<8?c(e,t):a(r(e.slice(0,u),t),r(e.slice(u),t),t)},c=function(e,t){var n,r,c=e.length,a=1;while(a<c){r=a,n=e[a];while(r&&t(e[r-1],n)>0)e[r]=e[--r];r!==a++&&(e[r]=n)}return e},a=function(e,t,n){var r=e.length,c=t.length,a=0,o=0,u=[];while(a<r||o<c)a<r&&o<c?u.push(n(e[a],t[o])<=0?e[a++]:t[o++]):u.push(a<r?e[a++]:t[o++]);return u};e.exports=r},b921:function(e,t,n){"use strict";var r=n("7a23"),c={class:"flex items-center mb-2"},a=Object(r["m"])("div",{class:"w-20 flex-none"},"Name",-1),o={class:"flex items-center mb-2"},u=Object(r["m"])("div",{class:"w-20 flex-none"},"Phone",-1),i={class:"flex items-center mb-2"},s=Object(r["m"])("div",{class:"w-20 flex-none"},"Address",-1);function b(e,t,n,b,d,l){var m=Object(r["R"])("a-input"),f=Object(r["R"])("a-modal");return Object(r["I"])(),Object(r["j"])(f,{visible:b.visibleModal,"onUpdate:visible":t[3]||(t[3]=function(e){return b.visibleModal=e}),width:"900px",title:b.customer.customerID?"Update Customer":"Create New Customer","confirm-loading":b.confirmModalLoading,afterClose:l.refreshModal,onOk:l.handleModalCustomerOk},{default:Object(r["cb"])((function(){return[Object(r["m"])("form",null,[Object(r["m"])("div",c,[a,Object(r["o"])(m,{value:b.customer.customerName,"onUpdate:value":t[0]||(t[0]=function(e){return b.customer.customerName=e}),class:"flex-auto"},null,8,["value"])]),Object(r["m"])("div",o,[u,Object(r["o"])(m,{value:b.customer.phone,"onUpdate:value":t[1]||(t[1]=function(e){return b.customer.phone=e}),class:"flex-auto"},null,8,["value"])]),Object(r["m"])("div",i,[s,Object(r["o"])(m,{value:b.customer.address,"onUpdate:value":t[2]||(t[2]=function(e){return b.customer.address=e}),class:"flex-auto"},null,8,["value"])])])]})),_:1},8,["visible","title","confirm-loading","afterClose","onOk"])}var d=n("1da1"),l=(n("96cf"),n("222b")),m={setup:function(){return{visibleModal:Object(r["N"])(!1),confirmModalLoading:Object(r["N"])(!1),customer:Object(r["N"])({customerID:"",customerName:"",phone:"",address:""})}},methods:{openModal:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.visibleModal=!0,!e){n.next=9;break}return n.next=4,Object(l["e"])(e);case 4:r=n.sent,t.customer.customerID=r.customerID,t.customer.customerName=r.customerName,t.customer.phone=r.phone,t.customer.address=r.address;case 9:case"end":return n.stop()}}),n)})))()},refreshModal:function(){this.customer.customerID="",this.customer.customerName="",this.customer.phone="",this.customer.address="",this.confirmModalLoading=!1},handleModalCustomerOk:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var n,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.confirmModalLoading=!0,n={customerName:e.customer.customerName,phone:e.customer.phone,address:e.customer.address},t.prev=2,e.customer.customerID){t.next=10;break}return t.next=6,Object(l["a"])(n);case 6:r=t.sent,e.$emit("actionCustomer",r),t.next=14;break;case 10:return t.next=12,Object(l["g"])(e.customer.customerID,n);case 12:c=t.sent,e.$emit("actionCustomer",c);case 14:e.visibleModal=!1,t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](2),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[2,17]])})))()}}},f=n("6b0d"),O=n.n(f);const p=O()(m,[["render",b]]);t["a"]=p},d81d:function(e,t,n){"use strict";var r=n("23e7"),c=n("b727").map,a=n("1dde"),o=a("map");r({target:"Array",proto:!0,forced:!o},{map:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0)}})},d8c5:function(e,t,n){"use strict";n.r(t);var r=n("7a23"),c=Object(r["m"])("h1",{class:"title-content"},"Thông tin khách hàng",-1),a={class:"flex justify-between"},o={class:"flex"},u=Object(r["m"])("div",{class:"w-10"},"Tên",-1),i=Object(r["m"])("div",{class:"w-3"},":",-1),s={class:"flex"},b=Object(r["m"])("div",{class:"w-10"},"SĐT",-1),d=Object(r["m"])("div",{class:"w-3"},":",-1),l={class:"flex"},m=Object(r["m"])("div",{class:"w-10"},"Đ/c",-1),f=Object(r["m"])("div",{class:"w-3"},":",-1),O=Object(r["n"])(" Edit "),p=Object(r["m"])("div",null,"NỢ",-1),j={class:"text-3xl"},h=Object(r["n"])(" Trả nợ "),v=Object(r["m"])("div",{class:"mt-4 mb-1 font-bold"},"Danh sách đơn hàng",-1),x={class:"wrapper-table"},g={class:"table"},w=Object(r["m"])("thead",null,[Object(r["m"])("th",null,"#"),Object(r["m"])("th",null,"Ngày"),Object(r["m"])("th",null,"T.Toán"),Object(r["m"])("th",null,"Tổng"),Object(r["m"])("th",null,"Nợ")],-1),D={class:"text-right"},k={key:0},y=Object(r["m"])("td",{class:"text-center",colspan:"7"},"No data available in table",-1),N=[y],R=["onDblclick"],E={class:"text-center"},I={class:"text-left"},T={class:"font-bold"},M=Object(r["m"])("div",{class:"mt-8 font-bold"},"Lịch sử trả nợ",-1),C={class:"wrapper-table mb-2"},L={class:"table"},S=Object(r["m"])("thead",null,[Object(r["m"])("th",null,"#"),Object(r["m"])("th",null,"Thời gian"),Object(r["m"])("th",null,"Tiền trả")],-1),P={class:"text-right"},A={key:0},U=Object(r["m"])("td",{class:"text-center",colspan:"3"},"No data available in table",-1),H=[U],V={class:"text-center"},X={class:"flex justify-between mt-4"},q=Object(r["n"])("Back"),$=Object(r["n"])(" Delete ");function Y(e,t,n,y,U,Y){var _,B,W=Object(r["R"])("a-button"),J=Object(r["R"])("ModalCustomerCreateModify"),K=Object(r["R"])("ModalPayDebt");return Object(r["I"])(),Object(r["l"])(r["b"],null,[c,Object(r["m"])("div",a,[Object(r["m"])("div",null,[Object(r["m"])("div",o,[u,i,Object(r["m"])("div",null,Object(r["V"])(y.customer.customerName),1)]),Object(r["m"])("div",s,[b,d,Object(r["m"])("div",null,Object(r["V"])(y.customer.phone),1)]),Object(r["m"])("div",l,[m,f,Object(r["m"])("div",null,Object(r["V"])(y.customer.address),1)]),Object(r["m"])("div",null,[Object(r["o"])(W,{onClick:t[0]||(t[0]=function(t){return e.$refs.modalCustomerCreateModify.openModal(y.customer.customerID)})},{default:Object(r["cb"])((function(){return[O]})),_:1}),Object(r["o"])(J,{ref:"modalCustomerCreateModify"},null,512)])]),Object(r["m"])("div",null,[p,Object(r["m"])("div",j,Object(r["V"])(null===(_=y.customer.finance)||void 0===_?void 0:_.debt),1)]),Object(r["m"])("div",null,[Object(r["o"])(W,{type:"primary",onClick:t[1]||(t[1]=function(t){return e.$refs.modalPayDebt.openModal(y.customer)})},{default:Object(r["cb"])((function(){return[h]})),_:1}),Object(r["o"])(K,{ref:"modalPayDebt"},null,512)])]),v,Object(r["m"])("div",x,[Object(r["m"])("table",g,[w,Object(r["m"])("tbody",D,[0===y.exportNoteList.length?(Object(r["I"])(),Object(r["l"])("tr",k,N)):Object(r["k"])("",!0),(Object(r["I"])(!0),Object(r["l"])(r["b"],null,Object(r["P"])(y.exportNoteList,(function(e,t){var n;return Object(r["I"])(),Object(r["l"])("tr",{key:t,onDblclick:function(t){return Y.redirectExportNoteDetails(e.exportNoteID)}},[Object(r["m"])("td",E,Object(r["V"])(t+1),1),Object(r["m"])("td",null,Object(r["V"])(Y.formatDateTime(e.createdAt)),1),Object(r["m"])("td",I,Object(r["V"])(null===(n=e.payment)||void 0===n?void 0:n.method),1),Object(r["m"])("td",null,Object(r["V"])(e.finance.revenue+e.finance.buyerPaysShip),1),Object(r["m"])("td",T,Object(r["V"])(e.finance.debt),1)],40,R)})),128))])])]),M,Object(r["m"])("div",C,[Object(r["m"])("table",L,[S,Object(r["m"])("tbody",P,[0==y.payDebtHistory.length?(Object(r["I"])(),Object(r["l"])("tr",A,H)):Object(r["k"])("",!0),(Object(r["I"])(!0),Object(r["l"])(r["b"],null,Object(r["P"])(y.payDebtHistory,(function(e,t){return Object(r["I"])(),Object(r["l"])("tr",{key:t},[Object(r["m"])("td",V,Object(r["V"])(t+1),1),Object(r["m"])("td",null,Object(r["V"])(Y.formatDateTime(e.time)),1),Object(r["m"])("td",null,Object(r["V"])(e.money),1)])})),128))])])]),Object(r["m"])("div",X,[Object(r["o"])(W,{onClick:t[2]||(t[2]=function(t){return e.$router.go(-1)})},{default:Object(r["cb"])((function(){return[q]})),_:1}),0===(null===(B=y.customer.exportNoteIDList)||void 0===B?void 0:B.length)?(Object(r["I"])(),Object(r["j"])(W,{key:0,onClick:Y.confirmDeleteCustomer,loading:y.loadingDeleteCustomer,type:"dashed"},{default:Object(r["cb"])((function(){return[$]})),_:1},8,["onClick","loading"])):Object(r["k"])("",!0)])],64)}var _=n("1da1"),B=(n("4e82"),n("d3b7"),n("25f0"),n("96cf"),n("6c02")),W=n("f64c"),J=n("ed3b"),K=n("96d9"),F=n("222b"),G=n("98ae"),z=n("b921"),Q=(n("7db0"),{class:"flex items-center mb-2"}),Z=Object(r["m"])("div",{class:"w-28 flex-none"},"Số tiền",-1),ee={class:"items-center mb-2"},te=Object(r["m"])("div",{class:"w-28 flex-none"},"Đơn hàng nợ",-1),ne={class:"inline-block w-10"},re={class:"inline-block w-20"},ce={class:"inline-block w-20"};function ae(e,t,n,c,a,o){var u=Object(r["R"])("a-input"),i=Object(r["R"])("a-checkbox"),s=Object(r["R"])("a-modal");return Object(r["I"])(),Object(r["j"])(s,{visible:c.visibleModal,"onUpdate:visible":t[0]||(t[0]=function(e){return c.visibleModal=e}),"confirm-loading":c.confirmModalLoading,onOk:o.startPayDebt,afterClose:o.refreshModal,title:"Trả nợ",width:"600px"},{default:Object(r["cb"])((function(){return[Object(r["m"])("div",Q,[Z,Object(r["o"])(u,{value:c.numberPayDebt,"onUpdate:value":o.changeNumberPayDebt,type:"number","addon-after":".000 vnđ",class:"flex-auto"},null,8,["value","onUpdate:value"])]),Object(r["m"])("div",ee,[te,Object(r["m"])("div",null,[(Object(r["I"])(!0),Object(r["l"])(r["b"],null,Object(r["P"])(c.noteListHasDebt,(function(e,t){return Object(r["I"])(),Object(r["l"])("div",{key:t,class:"mb-3"},[Object(r["o"])(i,{checked:!!c.noteListSelect.find((function(t){return t.exportNoteID===e.exportNoteID})),"onUpdate:checked":function(t){return o.changeCheckboxSelectDebt(t,e)}},{default:Object(r["cb"])((function(){var t;return[Object(r["m"])("span",ne,Object(r["V"])(null===(t=c.noteListSelect.find((function(t){return t.exportNoteID===e.exportNoteID})))||void 0===t?void 0:t.debt),1),Object(r["m"])("span",re,"/"+Object(r["V"])(e.finance.debt),1),Object(r["m"])("span",ce,Object(r["V"])(o.formatDateTime(e.updatedAt)),1),Object(r["m"])("span",null,"Tổng: "+Object(r["V"])(e.finance.revenue+e.finance.buyerPaysShip),1)]})),_:2},1032,["checked","onUpdate:checked"])])})),128))])])]})),_:1},8,["visible","confirm-loading","onOk","afterClose"])}n("159b"),n("4de4"),n("a9e3");var oe=n("bcc2"),ue={setup:function(){return{visibleModal:Object(r["N"])(!1),confirmModalLoading:Object(r["N"])(!1),customer:Object(r["N"])({}),numberPayDebt:Object(r["N"])(0),noteListHasDebt:Object(r["N"])([]),noteListSelect:Object(r["N"])([])}},methods:{openModal:function(e){var t=this;return Object(_["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t,t.visibleModal=!0,t.customer=e,n.next=5,Object(G["f"])(e.customerID);case 5:t.noteListHasDebt=n.sent.sort((function(e,t){return e.updatedAt>t.updatedAt?-1:e.updatedAt<t.updatedAt?1:0})),t.noteListHasDebt.forEach((function(e){r.noteListSelect.push({exportNoteID:e.exportNoteID,debt:e.finance.debt}),t.numberPayDebt+=e.finance.debt}));case 7:case"end":return n.stop()}}),n)})))()},refreshModal:function(){this.customer={},this.numberPayDebt=0,this.noteListSelect=[],this.noteListHasDebt=[]},changeCheckboxSelectDebt:function(e,t){e?this.noteListSelect.push({exportNoteID:t.exportNoteID,debt:t.finance.debt}):this.noteListSelect=this.noteListSelect.filter((function(e){return e.exportNoteID!==t.exportNoteID})),this.numberPayDebt=this.noteListSelect.reduce((function(e,t){return e+=t.debt,e}),0)},changeNumberPayDebt:function(e){var t=Number(e);this.noteListSelect=[];for(var n=this.noteListHasDebt.length-1;n>=0;n-=1){if(0===t)break;var r=this.noteListHasDebt[n],c=r.exportNoteID,a=r.finance,o=a.debt;t>o?(this.noteListSelect.push({exportNoteID:c,debt:o}),t-=o):(this.noteListSelect.push({exportNoteID:c,debt:t}),t=0)}this.numberPayDebt=Number(e)-t},startPayDebt:function(){var e=this;return Object(_["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.confirmModalLoading=!0,t.prev=1,t.next=4,Object(F["b"])(e.customer.customerID,e.noteListSelect,e.numberPayDebt);case 4:W["a"].success("Trả nợ thành công: ".concat(e.numberPayDebt),2),e.visibleModal=!1,t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error(t.t0),W["a"].error(t.t0.toString(),10);case 12:return t.prev=12,e.confirmModalLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[1,8,12,15]])})))()},formatDateTime:function(e){return Object(oe["a"])(e,"DD/MM/YY")}}},ie=n("6b0d"),se=n.n(ie);const be=se()(ue,[["render",ae]]);var de=be,le={components:{ModalCustomerCreateModify:z["a"],ModalPayDebt:de},setup:function(){var e=Object(B["c"])(),t=Object(F["f"])(e.params.id);return{customer:t.data,realtimeCustomer:t,exportNoteList:Object(r["N"])([]),payDebtHistory:Object(r["N"])([]),loadingDeleteCustomer:Object(r["N"])(!1)}},unmounted:function(){this.realtimeCustomer.unSubscribe()},watch:{"customer.exportNoteIDList":{handler:function(e,t){var n=this;return Object(_["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(G["e"])(e);case 2:n.exportNoteList=t.sent.reverse();case 3:case"end":return t.stop()}}),t)})))()},deep:!0},"customer.finance.payDebtHistory":{handler:function(e,t){var n=this;return Object(_["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.payDebtHistory=e.sort((function(e,t){return e.time>t.time?-1:e.time<t.time?1:0}));case 1:case"end":return t.stop()}}),t)})))()},deep:!0}},methods:{startDeleteCustomer:function(){var e=this;return Object(_["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loadingDeleteCustomer=!0,t.prev=1,e.realtimeCustomer.unSubscribe(),t.next=5,Object(F["d"])(e.customer.customerID);case 5:e.$router.push({name:"Customer List",params:{}}),W["a"].success("Delete customer success !!!",2),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),console.error(t.t0),W["a"].error(t.t0.toString(),10);case 13:return t.prev=13,e.loadingDeleteCustomer=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,9,13,16]])})))()},confirmDeleteCustomer:function(){if(this.customer.exportNoteIDList.length>0)this.$notification.open({message:"Lỗi !!!",description:"Đơn hàng của khách hàng này vẫn tồn tại. Không thể xóa khách hàng này",placement:"topRight",duration:5});else{var e=this;J["a"].confirm({title:"Confirm",icon:Object(r["o"])(K["a"]),content:"Bạn có chắc chắn muốn xóa khách hàng này ?",onOk:function(){e.startDeleteCustomer()}})}},redirectExportNoteDetails:function(e){this.$router.push({name:"ExportNote Details",params:{id:e}})},formatDateTime:function(e){return Object(oe["a"])(e,"DD/MM/YY")}}};const me=se()(le,[["render",Y]]);t["default"]=me},d998:function(e,t,n){var r=n("342f");e.exports=/MSIE|Trident/.test(r)}}]);
//# sourceMappingURL=chunk-0f986eae.c5bb3d17.js.map