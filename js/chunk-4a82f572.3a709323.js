(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a82f572"],{"15fd":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n("a4d3"),n("b64b");function r(t,e){if(null==t)return{};var n,r,c={},a=Object.keys(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||(c[n]=t[n]);return c}function c(t,e){if(null==t)return{};var n,c,a=r(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(c=0;c<o.length;c++)n=o[c],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}},4873:function(t,e,n){"use strict";n.d(e,"e",(function(){return O})),n.d(e,"h",(function(){return f})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return m})),n.d(e,"a",(function(){return h})),n.d(e,"f",(function(){return g})),n.d(e,"g",(function(){return w})),n.d(e,"i",(function(){return v})),n.d(e,"b",(function(){return x}));var r=n("3835"),c=n("1da1"),a=n("5530"),o=(n("96cf"),n("159b"),n("c740"),n("a434"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("4fad"),n("b64b"),n("99af"),n("e71f")),i=n("7a23"),u=n("bcc2"),s=(new Date).getFullYear(),b=(new Date).getMonth()+1,d=new Date(s+"-"+b).getTime(),O=Object(i["M"])([]),p=Object(o["j"])(),j=Object(o["n"])(Object(o["d"])(p,"IMPORTNOTE"),Object(o["r"])("updatedAt",">",d),Object(o["m"])("updatedAt","asc"));Object(o["l"])(j,(function(t){t.docChanges().forEach((function(t){var e=Object(a["a"])(Object(a["a"])({},t.doc.data()),{},{importNoteID:t.doc.id}),n=O.findIndex((function(e){return e.importNoteID===t.doc.id}));"added"===t.type?O.unshift(e):"modified"===t.type?O.splice(n,1,e):"removed"===t.type&&O.splice(n,1)}))}));var f=function(t){var e=Object(i["N"])({}),n=Object(o["l"])(Object(o["g"])(p,"IMPORTNOTE",t),function(){var n=Object(c["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.exists()){n.next=2;break}return n.abrupt("return");case 2:e.value=Object(a["a"])(Object(a["a"])({},r.data()),{},{importNoteID:t});case 3:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}());return{data:e,unSubscribe:n}},l=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("ID must not be empty");case 2:return n=Object(o["g"])(p,"IMPORTNOTE",e),t.next=5,Object(o["h"])(n);case 5:if(r=t.sent,r.exists()){t.next=8;break}throw new Error("ImportNote not found !!!");case 8:return t.abrupt("return",Object(a["a"])(Object(a["a"])({},r.data()),{},{importNoteID:r.id}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),m=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.map((function(t){return Object(o["h"])(Object(o["g"])(p,"IMPORTNOTE",t))})),t.next=3,Promise.all(n);case 3:return r=t.sent,t.abrupt("return",r.map((function(t){return Object(a["a"])(Object(a["a"])({},t.data()),{},{importNoteID:t.id})})));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),h=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object(u["a"])(new Date,"YY-MM-DD-HH-mm-ss"),r=Object(o["g"])(p,"IMPORTNOTE",n),t.next=4,Object(o["h"])(r);case 4:if(c=t.sent,!c.exists()){t.next=7;break}throw new Error("Phiếu nhập này đã tồn tại");case 7:return t.next=9,Object(o["p"])(r,Object(a["a"])(Object(a["a"])({},e),{},{status:"Pending",createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),removedAt:0}));case 9:return t.abrupt("return",r.id);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["o"])(p,function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(n){var c,i,u,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=Object(o["g"])(p,"IMPORTNOTE",e),t.next=3,n.get(c);case 3:if(i=t.sent,i.exists()){t.next=6;break}throw new Error("Document not exists");case 6:if(u=i.data(),s=Object.assign({},u),"Pending"===s.status){t.next=9;break}throw new Error("Notes is not in pending status");case 9:Object.entries(s.stockIn).forEach((function(t){var e=Object(r["a"])(t,2),i=e[0],u=e[1],s={};Object.entries(u).forEach((function(t){var e=Object(r["a"])(t,2),n=e[0],c=e[1].quantity,a="stockAvail."+n+".quantity";s[a]=Object(o["k"])(c)})),n.update(Object(o["g"])(p,"WAREHOUSE",i),Object(a["a"])(Object(a["a"])({},s),{},{importNoteIDList:Object(o["c"])(c.id)}))})),n.update(Object(o["g"])(p,"PROVIDER",s.provider.providerID),{importNoteIDList:Object(o["c"])(e)}),n.update(c,{status:"Success"});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),w=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["o"])(p,function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(n){var c,a,i,u,s,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=Object(o["g"])(p,"IMPORTNOTE",e),t.next=3,n.get(c);case 3:if(a=t.sent,a.exists()){t.next=6;break}throw new Error("Document not exists");case 6:if(i=a.data(),u=Object.assign({},i),"Success"===u.status){t.next=9;break}throw new Error("Notes is not in success status");case 9:return s=Object.keys(u.stockIn).map((function(t){return n.get(Object(o["g"])(p,"WAREHOUSE",t))})),t.next=12,Promise.all(s);case 12:b=t.sent,b.forEach((function(t){var c=t.data()||{},a=c.stockAvail,i=c.goodsName;Object.entries(u.stockIn[t.id]).forEach((function(t){var e=Object(r["a"])(t,2),n=e[0],c=e[1].quantity;if(!a[n])throw new Error("".concat(i," with ").concat(n," are not available in warehouse"));if(a[n].quantity<c)throw new Error("".concat(i," available is ").concat(a[n].quantity,". But, you have just export ").concat(c));a[n].quantity!==c?a[n].quantity-=c:delete a[n]})),n.update(Object(o["g"])(p,"WAREHOUSE",t.id),{stockAvail:a,importNoteIDList:Object(o["b"])(e)})})),n.update(Object(o["g"])(p,"PROVIDER",u.provider.providerID),{importNoteIDList:Object(o["b"])(e)}),n.update(c,{status:"Pending"});case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}throw new Error("ID must not be empty");case 2:return r=Object(o["g"])(p,"IMPORTNOTE",e),t.next=5,Object(o["h"])(r);case 5:if(c=t.sent,c.exists()){t.next=8;break}throw new Error("ImportNote not found !!!");case 8:if("Pending"===c.data().status){t.next=10;break}throw new Error("Notes is not in pending status");case 10:return t.next=12,Object(o["q"])(r,Object(a["a"])(Object(a["a"])({},n),{},{updatedAt:(new Date).getTime()}));case 12:return t.abrupt("return",e);case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),x=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["e"])(Object(o["g"])(p,"IMPORTNOTE",e));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},"7db0":function(t,e,n){"use strict";var r=n("23e7"),c=n("b727").find,a=n("44d2"),o="find",i=!0;o in[]&&Array(1)[o]((function(){i=!1})),r({target:"Array",proto:!0,forced:i},{find:function(t){return c(this,t,arguments.length>1?arguments[1]:void 0)}}),a(o)},"90a6":function(t,e,n){},b65c:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return d})),n.d(e,"a",(function(){return O})),n.d(e,"e",(function(){return p})),n.d(e,"b",(function(){return j}));var r=n("15fd"),c=n("1da1"),a=n("5530"),o=(n("96cf"),n("159b"),n("c740"),n("a434"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("e71f")),i=n("7a23"),u=["exportNoteIDList","importNoteIDList"],s=Object(i["M"])([]),b=Object(o["j"])();Object(o["l"])(Object(o["n"])(Object(o["d"])(b,"WAREHOUSE")),(function(t){t.docChanges().forEach((function(t){var e=Object(a["a"])({goodsID:t.doc.id},t.doc.data()),n=s.findIndex((function(e){return e.goodsID===t.doc.id}));"added"===t.type?s.push(e):"modified"===t.type?s.splice(n,1,e):"removed"===t.type&&s.splice(n,1)}))}));var d=function(t){var e=Object(i["N"])({}),n=Object(o["l"])(Object(o["g"])(b,"WAREHOUSE",t),function(){var n=Object(c["a"])(regeneratorRuntime.mark((function n(c){var i,s,d,O,p,j,f,l,m,h;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=c.data(),s=i.exportNoteIDList,d=i.importNoteIDList,O=Object(r["a"])(i,u),p=d.map((function(t){return Object(o["h"])(Object(o["g"])(b,"IMPORTNOTE",t))})),j=s.map((function(t){return Object(o["h"])(Object(o["g"])(b,"EXPORTNOTE",t))})),n.next=5,Promise.all(p);case 5:return f=n.sent,n.next=8,Promise.all(j);case 8:l=n.sent,m={},h={},f.forEach((function(t){m[t.id]=t.data()})),l.forEach((function(t){h[t.id]=t.data()})),e.value=Object(a["a"])(Object(a["a"])({goodsID:t},O),{},{exportNoteList:h,importNoteList:m});case 13:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}());return{data:e,unSubscribe:n}},O=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r,c,i,u,s,d,O;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.goodsName,r=e.group,c=e.unit,i=e.costPrice,u=e.retailPrice,s=e.wholesalePrice,t.next=3,Object(o["a"])(Object(o["d"])(b,"WAREHOUSE"),{goodsName:n,group:r,unit:c,costPrice:i,retailPrice:u,wholesalePrice:s,stockAvail:{},importNoteIDList:[],exportNoteIDList:[],createdAt:(new Date).getTime(),updatedAt:(new Date).getTime(),removedAt:0});case 3:return d=t.sent,t.next=6,Object(o["h"])(d);case 6:return O=t.sent,t.abrupt("return",Object(a["a"])({goodsID:O.id},O.data()));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=Object(o["g"])(b,"WAREHOUSE",e),t.next=3,Object(o["q"])(r,Object(a["a"])(Object(a["a"])({},n),{},{updatedAt:(new Date).getTime()}));case 3:return t.next=5,Object(o["h"])(r);case 5:return c=t.sent,t.abrupt("return",Object(a["a"])({goodsID:c.id},c.data()));case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),j=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["e"])(Object(o["g"])(b,"WAREHOUSE",e));case 2:return t.abrupt("return",e);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},bdc2:function(t,e,n){"use strict";n.r(e);n("b64b"),n("7db0");var r=n("7a23"),c=function(t){return Object(r["L"])("data-v-597e600e"),t=t(),Object(r["J"])(),t},a=c((function(){return Object(r["m"])("h1",{class:"title-content"},"Danh sách phiếu nhập hàng",-1)})),o={class:"flex justify-between mb-2 items-center"},i={class:"input-text"},u=["value"],s=Object(r["n"])(" Tạo Mới "),b={class:"wrapper-table"},d={class:"table"},O=c((function(){return Object(r["m"])("thead",null,[Object(r["m"])("tr",null,[Object(r["m"])("th",{rowspan:"2"},"#"),Object(r["m"])("th",{rowspan:"2"},"Nguồn"),Object(r["m"])("th",{colspan:"2"},"Hàng Nhập"),Object(r["m"])("th",{rowspan:"2"},"Tổng"),Object(r["m"])("th",{rowspan:"2"},"Ngày")]),Object(r["m"])("tr",null,[Object(r["m"])("th",null,"Tên"),Object(r["m"])("th",null,"SL")])],-1)})),p={style:{"text-align":"right"}},j={key:0},f=c((function(){return Object(r["m"])("td",{colspan:"10",style:{"text-align":"center"}},"No data available in table",-1)})),l=[f],m=["onClick"],h=["rowspan"],g=["rowspan"],w={style:{"text-align":"left"}},v=["rowspan"],x=["rowspan"],y={class:"mt-4"},I=Object(r["n"])("Back");function k(t,e,n,c,f,k){var N=Object(r["R"])("PlusOutlined"),R=Object(r["R"])("a-button");return Object(r["I"])(),Object(r["l"])(r["b"],null,[a,Object(r["m"])("div",o,[Object(r["m"])("div",i,[Object(r["m"])("input",{value:c.searchText,onInput:e[0]||(e[0]=function(){return k.handleSearchText&&k.handleSearchText.apply(k,arguments)}),type:"text",placeholder:"Search..."},null,40,u)]),Object(r["o"])(R,{type:"primary",onClick:k.redirectImportNoteCreate},{icon:Object(r["cb"])((function(){return[Object(r["o"])(N)]})),default:Object(r["cb"])((function(){return[s]})),_:1},8,["onClick"])]),Object(r["m"])("div",b,[Object(r["m"])("table",d,[O,Object(r["m"])("tbody",p,[0===k.importNoteFilter.length?(Object(r["I"])(),Object(r["l"])("tr",j,l)):Object(r["k"])("",!0),(Object(r["I"])(!0),Object(r["l"])(r["b"],null,Object(r["P"])(k.importNoteFilter,(function(t,e){return Object(r["I"])(),Object(r["l"])(r["b"],{key:e},[(Object(r["I"])(!0),Object(r["l"])(r["b"],null,Object(r["P"])(t.stockIn,(function(n,a,o){var i,u,s;return Object(r["I"])(),Object(r["l"])("tr",{key:o,onClick:function(e){return k.redirectImportNoteDetails(t.importNoteID)},style:Object(r["z"])("Pending"===t.status?"color: blue":"")},[0===o?(Object(r["I"])(),Object(r["l"])("td",{key:0,rowspan:Object.keys(t.stockIn).length},Object(r["V"])(k.importNoteFilter.length-e),9,h)):Object(r["k"])("",!0),0===o?(Object(r["I"])(),Object(r["l"])("td",{key:1,rowspan:Object.keys(t.stockIn).length,style:{"text-align":"left"}},Object(r["V"])((null===(i=t.provider)||void 0===i?void 0:i.providerName)||"-"),9,g)):Object(r["k"])("",!0),Object(r["m"])("td",w,Object(r["V"])((null===(u=c.goodsArray.find((function(t){return t.goodsID===a})))||void 0===u?void 0:u.goodsName)||"-"),1),Object(r["m"])("td",null,[(Object(r["I"])(!0),Object(r["l"])(r["b"],null,Object(r["P"])(n,(function(t,e,n){var c=t.quantity;return Object(r["I"])(),Object(r["l"])("p",{key:n},Object(r["V"])(c),1)})),128))]),0===o?(Object(r["I"])(),Object(r["l"])("td",{key:2,rowspan:Object.keys(t.stockIn).length},Object(r["V"])(null===(s=t.finance)||void 0===s?void 0:s.totalMoney),9,v)):Object(r["k"])("",!0),0===o?(Object(r["I"])(),Object(r["l"])("td",{key:3,rowspan:Object.keys(t.stockIn).length},Object(r["V"])(k.formatDateTime(t.createdAt)),9,x)):Object(r["k"])("",!0)],12,m)})),128))],64)})),128))])])]),Object(r["m"])("div",y,[Object(r["o"])(R,{onClick:e[1]||(e[1]=function(e){return t.$router.push({name:"Dashboard",params:{}})})},{default:Object(r["cb"])((function(){return[I]})),_:1})])],64)}n("4de4");var N=n("47ce"),R=n("4873"),D=n("b65c"),E=n("bcc2"),T={components:{PlusOutlined:N["a"]},setup:function(){return{goodsArray:D["c"],importNoteArray:R["e"],searchText:Object(r["N"])("")}},computed:{importNoteFilter:function(){var t=this;return this.importNoteArray.filter((function(e){return Object(E["c"])(e.provider.providerName,t.searchText)}))}},methods:{handleSearchText:function(t){this.searchText=t.target.value},redirectImportNoteCreate:function(){this.$router.push({name:"ImportNote Create Modify",params:{mode:"create"}})},redirectImportNoteDetails:function(t){this.$router.push({name:"ImportNote Details",params:{id:t}})},formatDateTime:function(t){return Object(E["a"])(t,"DD/MM/YY")}}},P=(n("db40"),n("6b0d")),A=n.n(P);const M=A()(T,[["render",k],["__scopeId","data-v-597e600e"]]);e["default"]=M},d81d:function(t,e,n){"use strict";var r=n("23e7"),c=n("b727").map,a=n("1dde"),o=a("map");r({target:"Array",proto:!0,forced:!o},{map:function(t){return c(this,t,arguments.length>1?arguments[1]:void 0)}})},db40:function(t,e,n){"use strict";n("90a6")}}]);
//# sourceMappingURL=chunk-4a82f572.3a709323.js.map